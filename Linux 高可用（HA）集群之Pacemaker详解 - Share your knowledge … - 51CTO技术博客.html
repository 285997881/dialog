<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0046)http://freeloda.blog.51cto.com/2033581/1274533 -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=GBK">

<script async="" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/analytics.js"></script><script async="" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/analytics.js"></script><script id="allmobilize" charset="utf-8" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/allmobilize.min.js"></script><style type="text/css"></style><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" media="handheld" href="http://freeloda.blog.51cto.com/#">


<title>Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客</title>
<meta name="description" content="大纲说明：本来我不想写这篇博文的，因为前几篇博文都有介绍pacemaker，但是我觉得还是得写一下，试想应该会有博友需要，特别是pacemaker1.1.8（CentOS6.4）以后，pacemaker有些特别要注意的变化，最后想说，敬开..">
<meta name="keywords" content="HA,高可用集群,Pacemaker详解,crmsh">
<meta http-equiv="Cache-Control" content="private">
<!--<base href="http://freeloda.blog.51cto.com/">--><base href=".">
<script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/def.js"></script>
<script language="javascript" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/message.js" type="text/javascript"></script>
<script language="javascript" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/user_comment.js" type="text/javascript"></script>
<script language="javascript" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/base2.js" type="text/javascript"></script>
<script language="javascript" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/dialog_utf8.js" type="text/javascript"></script>
<link href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/34.css" rel="stylesheet" type="text/css">
<link rel="alternate" href="http://freeloda.blog.51cto.com/rss.php?uid=2033581" type="application/rss+xml" title="RSS 2.0">
<link rel="edituri" type="application/rsd+xml" title="rsd" href="http://freeloda.blog.51cto.com/xmlrpc.php?rsd=1">
<link href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/header_master_top.css" rel="stylesheet" type="text/css">
<link href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/base.css" rel="stylesheet" type="text/css">
<style type="text/css">
	.mainNav li a{display:inline-block}
</style>
<script>
var myid = "";
function add_flink(){
	if(myid==""){

        var refurlk = "http://freeloda.blog.51cto.com/2033581/1274533";

				//commentSubmit("",refurlk);
				location.href="http://home.51cto.com/index.php?reback="+encodeURIComponent(encodeURIComponent(refurlk));
				
				return false;
	}else{
		var mtk = "87899c39f0951906e7d3e6d0134f8c08";
      		var url='/mod/edit_flink.php?type=addflink&uid=2033581&flink=http://freeloda.blog.51cto.com&mtk='+mtk;
		var ajax = InitAjax1();
		ajax.open("GET", url, true);
		ajax.onreadystatechange = function() {
			if (ajax.readyState == 4 && ajax.status == 200) {
				/*if(myid == 5290427){
					alert(ajax.responseText);
				}*/
				if(ajax.responseText==""){
					alert("添加成功。");
				}
				if(ajax.responseText=="1"){
				alert("链接指向自己。");
				}
				if(ajax.responseText=="2"){
				alert("友情链接已存在。")
				}
				if(ajax.responseText=="4"){
					alert("验证已过期。")
					}
			}
		}
		ajax.send(null);
	}



}
function sendmessage(){

	var refurlk = "http://freeloda.blog.51cto.com/2033581/1274533";

	if(myid){
		return true;
	}else{
		commentSubmit("",refurlk);
		return false;
	}
}
function copylink(ourl){
	if(!ourl){
		var clipBoardContent = "http://freeloda.blog.51cto.com";
	}else{
		var clipBoardContent = ourl;
	}
	window.clipboardData.setData("Text",clipBoardContent);
	alert("复制成功!");
	return false;
}
function correctPNG() {
if (document.getElementById('blog_touxian'))
{
var img = document.getElementById('blog_touxian');
      var imgName = img.src.toUpperCase()
      var imgID = (img.id) ? "id='" + img.id + "' " : ""
      var imgClass = (img.className) ? "class='" + img.className + "' " : ""
      var imgTitle = (img.title) ? "title='" + img.title + "' " : "title='" + img.alt + "' "
      var imgStyle = "display:inline-block;" + img.style.cssText
      if (img.align == "left") imgStyle = "float:left;" + imgStyle
      if (img.align == "right") imgStyle = "float:right;" + imgStyle
      if (img.parentElement.href) imgStyle = "cursor:hand;" + imgStyle
      var strNewHTML = "<span " + imgID + imgClass + imgTitle
         + " style=\"" + "width:" + img.width + "px; height:" + img.height + "px;" + imgStyle + ";"
         + "filter:progid:DXImageTransform.Microsoft.AlphaImageLoader"
         + "(src=\'" + img.src + "\', sizingMethod='scale');\"></span>" ;
      img.outerHTML = strNewHTML;
}
}
//window.attachEvent("onload", correctPNG);
window.onload=correctPNG;

function copy(){
var text=document.getElementById("txtUser").value;
if(copy2Clipboard(text)!=false){ 
alert("复制成功了！ "); 
} 
}
function copy2Clipboard(txt){ 
if(window.clipboardData){ 
window.clipboardData.clearData(); 
window.clipboardData.setData("Text",txt); 
}else if(navigator.userAgent.indexOf("Opera")!=-1){ 
window.location=txt; 
}else if(window.netscape){ 
try{ 
netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"); 
} 
catch(e){ 
alert("您使用的浏览器不支持此复制功能，请使用Ctrl+C或鼠标右键。"); 
return false; 
} 
var clip=Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard); 
if(!clip)return; 
var trans=Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable); 
if(!trans)return; 
trans.addDataFlavor('text/unicode'); 
var str=new Object(); 
var len=new Object(); 
var str=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString); 
var copytext=txt;str.data=copytext; 
trans.setTransferData("text/unicode",str,copytext.length*2); 
var clipid=Components.interfaces.nsIClipboard; 
if(!clip)return false; 
clip.setData(trans,null,clipid.kGlobalClipboard); 
return true;
} 
}

function mod_close(){
  document.getElementById('mod_tg').style.display="none";
}

function match_invite(uid) {
    var url='/mod/match_invite.php';
	var ajax = InitAjax();
    var re = 'uid=' + uid;
	ajax.open("POST", url, true);
    ajax.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	ajax.send(re);
    ajax.onreadystatechange = function() {
        if (ajax.readyState == 4 && ajax.status == 200) {
            if(ajax.responseText == 1){
                alert("邀请信息已经发送成功。");
            } else if(ajax.responseText=="-1"){
                alert("邀请失败，请稍候再试。");
            } else if(ajax.responseText=="2"){
                alert("该用户已经报名了。")
            }
        }
    }
}

</script>
<style type="text/css">
/*
.artContent img {max-width:450px !important;}
.showContent img{max-width:650px!important;}
*/

.artContent img{max-width: 450px; width:expression(this.width > 450 ? "450px" : this.width)}
/*
.showContent img{max-width: 450px; width:expression(this.width > 650 ? "650px" : this.width)}
*/


</style>
<script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/share.js"></script><script charset="utf-8" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/lightapp.js" async="" name="baidu-tc-cerfication"></script><style id="table">
.showContent table.noBorderTable td,.showContent table.noBorderTable th,.showContent table.noBorderTable caption{border:1px dashed #ddd !important}.showContent table{margin-bottom:10px;border-collapse:collapse;display:table;}.showContent td,.showContent th{ background:white; padding: 5px 10px;border: 1px solid #DDD;}.showContent caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}.showContent th{border-top:2px solid #BBB;background:#F7F7F7;}.showContent td p{margin:0;padding:0;}
.showContent table.noBorderTable td,.showContent table.noBorderTable th,.showContent table.noBorderTable caption{border:1px dashed #ddd !important}.showContent table{margin-bottom:10px;border-collapse:collapse;display:table;}.showContent td,.showContent th{ background:white; padding: 5px 10px;border: 1px solid #DDD;}.showContent caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}.showContent th{border-top:2px solid #BBB;background:#F7F7F7;}.showContent td p{margin:0;padding:0;}</style><style id="list">
.showContent ol,.showContent ul{margin:0;pading:0;}.showContent .list-paddingleft-1{padding-left:0}
.showContent .list-paddingleft-2{padding-left:20px}
.showContent .list-paddingleft-3{padding-left:40px}
.showContent ol,.showContent ul{margin:0;pading:0;}.showContent .list-paddingleft-1{padding-left:0}
.showContent .list-paddingleft-2{padding-left:20px}
.showContent .list-paddingleft-3{padding-left:40px}</style><link rel="stylesheet" href="http://bdimg.share.baidu.com/static/api/css/share_style1_32.css"></head>

<body>

<div id="home_top">
<div class="top_nav" style="width:990px;">
<div class="left" style="margin-top:10px; width:440px;"><a href="http://blog.51cto.com/" target="_blank"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/head_blog_sibebar_logo.gif" align="absmiddle" style="margin-top:-4px;"></a><a target="_blank" href="http://www.51cto.com/">51CTO首页</a><img height="25" align="absmiddle" width="16" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/top_bg_xian.gif" style="margin-top:-4px;"><a href="http://blog.51cto.com/" target="_blank">51CTO博客</a><img height="25" align="absmiddle" width="16" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/top_bg_xian.gif" style="margin-top:-4px;"><a href="http://home.51cto.com/?reback=http%253A%252F%252Ffreeloda.blog.51cto.com%252F2033581%252F1274533">我的博客</a><img height="25" align="absmiddle" width="16" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/top_bg_xian.gif" style="margin-top:-4px;">

<a target="_blank" href="http://blog.51cto.com/search.php">搜索</a>
<a href="javascript:void(0);" style="color: rgb(255, 0, 0); text-decoration: underline;" id="showMessagerDim">每日博报</a>
</div>

<div class="right" style="width:550px;">
<div class="more"><img height="16" align="absmiddle" width="27" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/top_shequ.gif">社区：<a target="_blank" href="http://edu.51cto.com/" style="color: rgb(204, 0, 0);">学院</a><a target="_blank" href="http://bbs.51cto.com/">论坛</a><a target="_blank" href="http://blog.51cto.com/">博客</a><a target="_blank" href="http://down.51cto.com/">下载</a><a href="javascript:viod(0);" onmouseout="popupClose()" onmouseover="show(3,this)">更多<img align="absmiddle" style="padding-left: 4px;" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/nav_ico1.gif"></a>            </div>            <span id="login_status"><div class="login" style="padding-top:8px; text-align:right;"><a href="http://edu.51cto.com/top" style="background:none"><img style="margin-top:-3px" id="dia" align="absmiddle" width="20" title="今天你领学分了吗？" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/dia.gif"></a><a href="http://home.51cto.com/?reback=http%253A%252F%252Ffreeloda.blog.51cto.com%252F2033581%252F1274533" target="_self">登录</a><a href="http://ucenter.51cto.com/reg_01.php?reback=http%253A%252F%252Ffreeloda.blog.51cto.com%252F2033581%252F1274533" target="_self">注册</a></div></span>                </div>    </div></div>



<div class="subMenu3" id="s3" onmouseover="popupNoClose()" onmouseout="popupClose()">
<ul>
<li><a href="http://home.51cto.com/" target="_blank">家园</a></li>
<li><a href="http://edu.51cto.com/" target="_blank">学院</a></li>
<li><a href="http://blog.51cto.com/" target="_blank">博客</a></li>
<li><a href="http://bbs.51cto.com/" target="_blank">论坛</a></li>
<li><a href="http://down.51cto.com/" target="_blank">下载</a></li>

<li><a href="http://selftest.51cto.com/" target="_blank">自测</a></li>
<li><a href="http://doctor.51cto.com/" target="_blank">门诊</a></li>
<li><a href="http://blog.51cto.com/newsletter/" target="_blank">周刊</a></li>
<li><a href="http://book.51cto.com/" target="_blank">读书</a></li>
<li><a href="http://g.51cto.com/" target="_blank">技术圈</a></li>
</ul>
</div>
<!--简导航end-->



<div class="headerBox">
<div class="header">
<div class="header_l">
<div class="logo_blogname">


<div class="blogLogo">
<a href="http://blog.51cto.com/blogcommend" target="_blank"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/blogLogo01.png" width="161px;" height="70px;"></a>
</div>


<div class="blogName">
<a href="http://freeloda.blog.51cto.com/"><h1>Share your knowledge …</h1></a>
</div>
</div><!--logo_blogname end-->
<div class="blogLink">

<a href="http://freeloda.blog.51cto.com/">http://freeloda.blog.51cto.com</a> <input id="txtUser" type="hidden" size="32" value="http://freeloda.blog.51cto.com">   <a href="javascript:void(0);" onclick="copy();">【复制】</a> <a href="http://freeloda.blog.51cto.com/rss.php?uid=2033581" target="_blank"></a><a href="http://freeloda.blog.51cto.com/rss.php?uid=2033581" target="_blank">【订阅】</a>

</div>



</div><!--header_l end-->
<div class="header_r">
<div class="blogInfo"><span><a href="http://freeloda.blog.51cto.com/2033581/o" title="察看陈明乾所有原创文章">原创</a>:158</span><span><a href="http://freeloda.blog.51cto.com/2033581/t" title="察看陈明乾所有翻译文章">翻译</a>:1</span><span><a href="http://freeloda.blog.51cto.com/2033581/c" title="察看陈明乾所有转载文章">转载</a>:3</span></div>
<div class="blogNav"><a href="http://freeloda.blog.51cto.com/">博 客</a>|<a href="http://home.51cto.com/apps/photo/index.php?s=/Index/photos/uid/2033581">图库</a>|<a href="http://freeloda.blog.51cto.com/addblog.php">写博文</a>|<a href="http://51ctoblog.blog.51cto.com/all/26414/4" target="_blank">帮 助</a></div>
</div>
</div>
<!--header end-->
</div><!--headerBox end-->
<div class="mainNav">
<span class="mainNavT"></span>
<ul>
<li><a href="http://freeloda.blog.51cto.com/">首页</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-1">Linux基础专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-2">Linux服务专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-3">MySQL数据库专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-4">Linux集群与存储专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-9">Linux性能调优专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-7">Linux工具专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-11">Linux安全专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-12">Linux监控专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-14">Linux系统架构专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-15">HTTP加速及应用服务器专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-17">Linux虚拟化专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-18">Linux自动化运维专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-19">Python 专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-20">Linux日志分析工具专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-21">Linux故障排除专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-22">OpenVPN专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-23">PHP+Shell专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-24">Git与GitHub专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-25">代码发布与管理控制专题</a></li>|<li><a href="http://freeloda.blog.51cto.com/2033581/d-13">常用小技巧</a></li>
</ul>
<span class="mainNavB"></span>
</div>
<!--mainNav end-->

<script type="text/javascript" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/jquery-1.7.1.min.js"></script>
<!--[if IE 6]>
  <script type="text/javascript" src="http://images.watchstor.com/newhomes/png.js"></script>
  <script>
    DD_belatedPNG.fix('img,input,ul,li, .get-box, div, .add, .sub, .ui-slider-handle, .footer-chopper');
  </script>
<![endif]-->
<link type="text/css" rel="stylesheet" href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/fck_editorarea.css">
<script type="text/javascript" charset="gbk" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/shCores.js"></script>
<link rel="stylesheet" type="text/css" href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/shCoreDefault.css">
<script type="text/javascript" charset="gbk" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/uparse.js"></script>
<script type="text/javascript">
	uParse('.showContent');
	$(function(){
		//SyntaxHighlighter.config.clipboardSwf = 'http://bbs.51cto.com/plugins/syntaxhighlighter/scripts/clipboard.swf'; 
		//为了在编辑器之外能展示高亮代码
		SyntaxHighlighter.highlight();
	}); 
</script>
<script type="text/javascript">
/**
 * 回复评论需要用的js
 * 2012-5-14
 * by:chengtao
 */
 jQuery(function(){
	blogpost.init();//初始化博客回复功能
 })
 /**
  * 处理博文评论功能优化
  */
 blogpost={
	abstruct_list:null,
	init:function(){
		blogpost.bind();//绑定一些时间
		this.abstruct_list=new Array();//初始化保存评论信息的数组
	},
	/**
	 * 博客回复需要绑定的一些事件
	 */
	bind:function(){
		/**
		 * 点击回复的事件
		 */
		jQuery('.repost').live('click',function(){
			blogpost.repost(jQuery(this).attr('user_name'),jQuery(this).attr('parentid'));
			return false;
		});
		/**
		 * 点击楼层进行翻页且找到锚点
		 */
		jQuery('.anchor_page').live('click',function(){
			var parentid = $(this).attr('parentid');
			var tid=$(this).attr('tid');
			$.get('/comments.php?tid='+tid+'&parentid='+parentid,function(data){
				$('#artcomment').html(data);
				window.location.hash=''+parentid;
			})
			return false;
		}),
		jQuery('.anchor_page').live('mouseover',function(){
			var parentid = $(this).attr('parentid');
			if(!blogpost.abstruct_list[parentid]){
				var this_t = $(this);
				$.get('/comments.php?cid='+parentid,function(data,textStatus){
					blogpost.abstruct_list[parentid]=data;
					this_t.attr('title',this_t.text()+':'+ blogpost.abstruct_list[parentid]);
				});
			}else{
				$(this).attr('title',$(this).text()+':'+blogpost.abstruct_list[parentid]);
			}
		})
	},
	/**
	 * @param user_name 用户名
	 * @param parentid  父评论id
	 */
	repost:function(user_name,parentid){
		window.location.hash='comment';
		jQuery('#parentid').val(parentid);
		jQuery('#commentcontent').val('回复 '+user_name+":\n").focus();
		if(!$.browser.mozilla){
			var elem = jQuery('#commentcontent')[0];		
			var caretPos = elem.value.length;
			if (elem.createTextRange) {
				var range = elem.createTextRange();
				range.move('character', caretPos);
				range.select();
			}else{
				elem.setSelectionRange(caretPos, caretPos);	
			}
		}
	},
	/**
	 * 发送完毕之后清理表单数据 不是ajax可能用不到
	 */
	clean:function(){
		
	}
 }
</script>
<script type="text/javascript">
jQuery(function(){
	var anchor = document.location.hash;
	var comment_id=anchor.split('#')[1];
	if(!isNaN(parseInt(comment_id))){//是整形
		jQuery.get('/comments.php?tid=1274533&parentid='+comment_id,function(data){
			jQuery('#artcomment').html(data);
			window.location.hash=''+comment_id;
		})
	}
});
</script>



<script type="text/javascript">
jQuery(function() {
	jQuery('#favourdiv').mouseover(function(){
		if(jQuery(this).attr('className') == 'support01')
		{
			jQuery(this).attr('className', "support02");
			jQuery(this).html('+1人');
			jQuery(this).attr('title', "赞一个，我支持TA");
		}
		else if(jQuery(this).attr('className') == 'support03')
		{
			jQuery(this).attr('title', "你已经赞了这篇博文！");
		}
		
	});
	jQuery('#favourdiv').mouseout(function(){
		if(jQuery(this).attr('className') == 'support02')
		{
			jQuery(this).attr('className', "support01");
			jQuery(this).html("15人");
		}
	});
	jQuery('.blog_match_yq').click(function(){
		var wind_uid = '';
		if(!wind_uid){
			alert("请先登录！");
			return false;
		}
		jQuery.ajax({
			   type: "POST",
			   url:"/contest2012/index.php?mod=sendmsg",
			   dataType: "html",
			   data: "vuid=" + 2033581,
			   success: function(data) {
					if(data == 0)
					{
						alert("查无此人！");
						return false;
					}else if(data == 1){
						alert("请先登录！");
						return false;
					}else if(data == 2){
						alert("不能邀请自己！");
						return false;
					}else if(data == 22){  
						alert("邀请信息已发出！");
						return false;
					}
			   }
		  });
	});
	jQuery('#favourdiv').click(function(){
			jQuery.ajax({
			   type: "POST",
			   url:"/mod/favour.php",
			   dataType: "html",
			   data: "tid=" + 1274533,
			   success: function(data) {
					if(data == 0)
					{
						alert("您还未登录或者已过期，请重新登录");
						location.href = "http://home.51cto.com/index.php?reback=http%253A%252F%252Ffreeloda.blog.51cto.com%252F2033581%252F1274533";
						return false;
					}
					else if(data == '-1')
					{
						alert("参数传递错误！");
						return false;
					}
					else if(data == '-2')
					{
						alert("该博文已被删除或者不存在！");
						return false;
					}
					else if(data == '-3')
					{
						alert("您已经赞过了！");
						return false;
					}
					else if(data == '-4')
					{
						alert("赞操作失败！");
						return false;
					}
					else
					{  
						//alert("操作成功，你已经赞了这篇博文！");
						jQuery('#favourdiv').attr('className', "support03");

						var num = 15 + 1 + "人";
						jQuery('#favourdiv').html(num);
						jQuery('#favourer').html(data);
						return false;
					}
			   }
		  });
	});
	//Jaydar http://blog.51cto.com/js/header.php?uid=blogdb[uid]&tid=tid
	jQuery.post('/js/header.php',{uid:2033581,tid:1274533},function(data){
		jQuery('#readNum').html(data[0]);
		jQuery('#cmtNum').html(data[1]);
	},'json');
	

})

jQuery(function(){
	jQuery('#darid').bind('click',function(){
		if(confirm("你确定删除此篇文章？")){
			jQuery.ajax({
				'type':'post',
				'url':'user_index.php?action=delarticle',
				'data':{'job':'del', 'selid':'1274533', 'mhash':''},
				'dataType':'html',
				'success':function(res){
					if('ok' == res){
						location.href="http://.blog.51cto.com";
					}
				
				}
			});
		}
	});
});
</script>




<style type="text/css">
.m_sharelinks{ 
	line-height:30px; 
	text-align:left; 
	padding-left:20px; 
	//background:url(http://img1.51cto.com/images/share/ico_lb.gif) no-repeat left center;
	float:left; 
	width:600px; 
	height:30px;
}
.m_sharelinks a{ margin-left:10px;}
.m_sharebtn{ height:50px; width:726px; margin:0 auto;}
.m_sharebtn01{width:520px; float:left;}
.weibo_51cto{ background:url(http://img1.51cto.com/images/share/ico_mweibo.gif) no-repeat center center; display:block; width:33px; height:33px; float:left; margin:3px 3px 0 0;cursor:pointer;}
.shareMored {
    line-height: 30px;
	float:right; 
	text-align:right; 
	width:100px; 
	height:30px;
}

.showContent {
	margin:20px 15px 8px;
}
.userImage img {
    text-align: center;
	border:0;
	padding:0;
}
.photo_links{ line-height:30px; padding-top:5px; font-size:13px;width:170px; margin:0 auto;}
.photo_links_blue{ text-align:center;}
.photo_links_blue a:link,.photo_links_blue a:visited,.photo_links_blue a:hover,.photo_links_blue a:active{ color:#015F91; text-decoration: underline;}
.photo_links_red{ text-align:left;}
.photo_links_red a:link,.photo_links_red a:visited,.photo_links_red a:hover,.photo_links_red a:active{ color:#fc4343; text-decoration:underline;}
.photo_links_red02{ text-align:center;}

.vlist{ margin:10px 10px; height:65px;}
.vlist img{ float:left; margin-right:10px;}
.vlist dl{ text-align:left;}
.vlist dl dt{ height:40px;line-height: 20px; overflow:hidden; padding-top:5px;}
.vlist dl dt,.vlist dl dt a{ color:#262626;}
.vlist dl dd,.vlist dl dd a{ color:#777;}

.video-icon{
    position: relative;
}
.video-icon a.i_video {
    background: url("http://www.51cto.com/images/homepage/Images/eduplay.png") repeat scroll 0 0 rgba(0, 0, 0, 0);
    display: block;
    height: 25px;
    left:31px;
    position: absolute;
    top:22px;
    width: 25px;
    z-index: 10;
}

.ipadFload{ position:fixed; width:136px; height:194px; background:url("http://bbs.51cto.com/images/IPad-bg.png") left top no-repeat #fff; font-family:"微软雅黑"; padding-left:18px;}
.ipadClose{ text-align:right; font-size:14px; line-height:20px;}
.ipadImg{ padding-top:38px;}
.ipadImg img{ width:105px; height:105px;}
.iPadair2{ font-size:12px;}
.iPadair2 a{ color:#659b01; text-decoration:none; background:url("http://bbs.51cto.com/images/51CTO-IPAD-BOTTOM.png") right center no-repeat; display:block; line-height:30px;}

</style>
<script language="JavaScript" type="text/javascript" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/group.js"></script>
<div id="add_sys_type_div" style="width:600px;border:1px #58B0DD solid; background-color:#FFF; position:absolute;left:30%;top:300px;display:none;z-index:255"></div>
<div id="add_sys_type_dvs" style="width:550px;border:1px #58B0DD solid; background-color:#FFF; position:absolute;left:30%;top:300px;display:none;z-index:255"></div>
	



<div class="blogMain">
<div class="blogLeft">


<div class="box moduleUser">
<div class="title">
<h2><strong>陈明乾</strong> 的BLOG  </h2>
</div>
<div class="modCon">

<div class="userImage" style="margin: 10px auto 5px;text-align: center;width: 130px;border: 1px solid #D4D4D4;">
	<table width="100%" cellpadding="0" cellspacing="0">
		<tbody><tr>
			<td valign="middle" align="center" height="130"><script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/userface.php"></script><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar.php" id="userface"></td>
		</tr>
	</tbody></table>
</div>
<div class="photo_links">
</div>









<div class="crumbs">
<a href="http://home.51cto.com/index.php?s=/space/2033581#message" class="writeMessage" target="_blank">写留言</a><a href="http://edu.51cto.com/" class="inCircle" target="_blank">去学院学习</a><a href="http://home.51cto.com/index.php?s=/Notify/write/uid/2033581" class="message" target="_blank">发消息</a>
 <a href="http://freeloda.blog.51cto.com/" onclick="add_flink(2033581);return false" class="joinLinks">加友情链接</a><a href="http://home.51cto.com/index.php?s=/space/2033581" class="joinFriends" target="_blank">进家园 加好友</a>
</div>

<div style="width:239px;height:64px;display:none;">


<div style="float:left;"><p style="padding:15px 0 0 28px; line-height:20px;">2012年度IT博客大赛<br><a target="_blank" href="http://blog.51cto.com/contest2012/#top10000" style="color:#F00; text-decoration:underline;">十大杰出IT博客诞生</a></p></div>
<div style="float:right;"><a target="_blank" href="http://blog.51cto.com/contest2012/"><img width="57" height="27" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/blog_match_endlook.jpg" style="margin:23px 20px 0 0;"></a></div>
<!-- <div style="float:left;"><p style="padding:15px 0 0 28px; line-height:20px;">星光评委正在评选<br><a target="_blank" href="http://blog.51cto.com/contest2012/index.php?mod=userlist_sec" style="color:#F00; text-decoration:underline;">2012年度IT博客大赛50强</a></p></div>
<div style="float:right;"><img class="blog_match_yq" width="57" height="27" src="http://img1.51cto.com/images/blog_match_invite.jpg" style="margin:23px 20px 0 0;"></div> -->



<div class="clear"></div>
</div>


</div><!--modCon end-->
<span class="modBot"></span>
</div>


<div class="infoList box">
<div class="title">
<h2>博客统计信息</h2>
</div>
<div class="modCon">
<p>
<span class="infoListHead"><a href="http://blog.51cto.com/blogcommend" target="_blank" class="operlink"><b>51CTO推荐博客</b></a> <br></span>
用户名：陈明乾<br>
文章数：163<br>
评论数：706<br>
访问量：528716<br>
<a href="http://home.51cto.com/index.php?s=/Account/credit" target="_blank">无忧币</a>：9765<br>
<a href="http://51ctoblog.blog.51cto.com/26414/5591" target="_blank">博客积分</a>：3270<br>
<a href="http://51ctoblog.blog.51cto.com/26414/5591" target="_blank">博客等级</a>：7<br>
注册日期：2010-08-19<br>
<script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/blogno1countdown.php"></script> 
</p>
</div>
<span class="modBot"></span>
</div>


<div class="infoList box">
	<div class="title">
		<h2 class="fl">热门专题</h2>
		<a target="_blank" class="fr" href="http://blog.51cto.com/zt">更多&gt;&gt;</a>
	</div>
	<div class="modCon" style="height: 88px;">

		
		
	</div>
	<span class="modBot"></span>
</div>


<div class="hotArt box">
<div class="title">
<h2>热门文章</h2>
</div>
<div class="modCon">
<ul>
<li><a href="http://freeloda.blog.51cto.com/2033581/1288553">Nginx 反向代理、负载均..</a></li>
<li><a href="http://freeloda.blog.51cto.com/2033581/1245492">CentOS6.4+LAMP+Postfix+..</a></li>
<li><a href="http://freeloda.blog.51cto.com/2033581/1252067">CentOS6.4+MySQL-5.6.12 ..</a></li>
<li><a href="http://freeloda.blog.51cto.com/2033581/1306743">SNMP 原理与实战详解</a></li>
<li><a href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客.html">Linux 高可用（HA）集群..</a></li>
<li><a href="http://freeloda.blog.51cto.com/2033581/1299644">Tomcat系列之服务器的安..</a></li>
<li><a href="http://freeloda.blog.51cto.com/2033581/1260824">CentOS 5/6.X 使用 EPEL ..</a></li>
<li><a href="http://freeloda.blog.51cto.com/2033581/1272417">Linux 高可用（HA）集群..</a></li>

</ul>
</div>
<span class="modBot"></span>
</div>
<div class="search box">
<div class="title"><h2>搜索BLOG文章</h2></div>
<div class="modCon">
<form method="post" action="http://freeloda.blog.51cto.com/search.php?" tabindex="99">
<input type="hidden" name="step" value="2">
<input type="hidden" name="authorid" value="2033581">
<input type="hidden" name="sch_area" value="S">
<input type="text" value="" name="keyword" class="searchInput">
<input type="submit" value="搜 索" class="searchBtn">
</form>
</div><!--modCon end-->
<span class="modBot"></span>
</div>


<div class="box recentGuests">
<div class="title">
<h2>最近访客</h2>
</div>
<div class="modCon">
<ul>

<li><a href="http://ly36843.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(1).php"></a>
<p><a href="http://ly36843.blog.51cto.com/">ly36843</a></p>

</li><li><a href="http://9982529.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(2).php"></a>
<p><a href="http://9982529.blog.51cto.com/">qingd..</a></p>

</li><li><a href="http://79076431.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(3).php"></a>
<p><a href="http://79076431.blog.51cto.com/">bjwf125</a></p>

</li><li><a href="http://5609547.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(4).php"></a>
<p><a href="http://5609547.blog.51cto.com/">99光光99</a></p>

</li><li><a href="http://7292220.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(5).php"></a>
<p><a href="http://7292220.blog.51cto.com/">sqeues</a></p>

</li><li><a href="http://843455.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(6).php"></a>
<p><a href="http://843455.blog.51cto.com/">wumin..</a></p>

</li><li><a href="http://167910.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(7).php"></a>
<p><a href="http://167910.blog.51cto.com/">水水超</a></p>

</li><li><a href="http://2232284.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(8).php"></a>
<p><a href="http://2232284.blog.51cto.com/">kangl..</a></p>

</li><li><a href="http://10169562.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(9).php"></a>
<p><a href="http://10169562.blog.51cto.com/">miran..</a></p>

</li><li><a href="http://bingoku.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(10).php"></a>
<p><a href="http://bingoku.blog.51cto.com/">bingoku</a></p>

</li><li><a href="http://skypegnu1.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(11).php"></a>
<p><a href="http://skypegnu1.blog.51cto.com/">skype..</a></p>

</li><li><a href="http://10169356.blog.51cto.com/"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/avatar(12).php"></a>
<p><a href="http://10169356.blog.51cto.com/">下午..</a></p>

</li></ul>
<span class="clear"></span>
</div>
<span class="modBot"></span>
</div>


<div class="newComments box">
<div class="title">
<h2>最新评论 

</h2>



</div>
<div class="modCon">
<ul>

<li><a href="http://bingoku.blog.51cto.com/" class="operlink" target="_blank"><b>bingoku</b></a>：<a href="http://freeloda.blog.51cto.com/2033581/1324498" target="_blank">博主，你好，有一个地方纠结了好久..</a></li>

<li><a href="http://mondeolove.blog.51cto.com/" class="operlink" target="_blank"><b>MonDeoLove</b></a>：<a href="http://freeloda.blog.51cto.com/2033581/1275528" target="_blank">primitive mysqldrbd ocf:heartbeat..</a></li>

<li><a href="http://10250211.blog.51cto.com/" class="operlink" target="_blank"><b>linuxsec_cn</b></a>：<a href="http://freeloda.blog.51cto.com/2033581/1252067" target="_blank">report-host=master.magedu.com 这..</a></li>

<li><a href="http://204324.blog.51cto.com/" class="operlink" target="_blank"><b>c9912115</b></a>：<a href="http://freeloda.blog.51cto.com/2033581/1438052" target="_blank">嗯、嗯。希望像学长一样~   努力...</a></li>

<li><a href="http://freeloda.blog.51cto.com/" class="operlink" target="_blank"><b>陈明乾</b></a>：<a href="http://freeloda.blog.51cto.com/2033581/1438052" target="_blank">回复 c9912115: 嘿嘿，共同学习，..</a></li>


</ul>
</div>
<span class="modBot"></span>
</div>


<div class="hotBlogArt box">
<div class="title">
  <h2 class="fl">51CTO推荐博文</h2>
  <a href="http://blog.51cto.com/artcommend" class="fr">更多&gt;&gt;</a></div>
<div class="modCon">
<ul>
<li><a href="http://bbotte.blog.51cto.com/6205307/1657305" title="loadrunner安装运行一步一步来（多图）" target="_blank">loadrunner安装运行一步一步来（..</a></li>
<li><a href="http://shutong.blog.51cto.com/1559738/1656207" title="利用Microsoft Azure Traffic Manager保证业务的可用性" target="_blank">利用Microsoft Azure Traffic Man..</a></li>
<li><a href="http://wenzhongxiang.blog.51cto.com/6370734/1657334" title="MDT 2013 从入门到精通之Task部署任务创建" target="_blank">MDT 2013 从入门到精通之Task部署..</a></li>
<li><a href="http://wangchunhai.blog.51cto.com/225186/1657346" title="某房产中介服务器托管及安全方案（上）" target="_blank">某房产中介服务器托管及安全方案..</a></li>
<li><a href="http://dufei.blog.51cto.com/382644/1656934" title="Exchange Server 运维管理01：Exchange中Active Directory 有什么用？" target="_blank">Exchange Server 运维管理01：Exc..</a></li>
<li><a href="http://yuanquan.blog.51cto.com/9996673/1656805" title="Server 2012之利用NLB实现WEB站点的的高可用" target="_blank">Server 2012之利用NLB实现WEB站点..</a></li>
<li><a href="http://bbotte.blog.51cto.com/6205307/1655588" title="docker操作运行一步一步来" target="_blank">docker操作运行一步一步来</a></li>
<li><a href="http://stephen1991.blog.51cto.com/8959108/1655787" title="XenApp_XenDesktop_7.6实战篇之一：走进桌面虚拟化世界" target="_blank">XenApp_XenDesktop_7.6实战篇之一..</a></li>
<li><a href="http://jiushu.blog.51cto.com/972756/1655345" title="PowerShell批量为用户添加SMTP邮箱" target="_blank">PowerShell批量为用户添加SMTP邮箱</a></li>
<li><a href="http://8802265.blog.51cto.com/8792265/1655196" title="linux下配置squid代理服务器" target="_blank">linux下配置squid代理服务器</a></li>
<li><a href="http://jiechao2012.blog.51cto.com/3251753/1655346" title="实战部署openldap主从架构" target="_blank">实战部署openldap主从架构</a></li>

</ul>
</div><!--modCon end-->
<span class="modBot"></span>
</div>


<div class="friendLink box">
<div class="title">
  <h2>友情链接</h2>
</div>
<div class="modCon">
<ul>

<li><a href="http://www.178linux.com/" title="马哥教育-运维部落" target="_blank">马哥教育-运维部落</a></li>

<li><a href="http://edu.51cto.com/" title="IT精品课程" target="_blank">IT精品课程</a></li>

<li><a href="http://www.magedu.com/" title="" target="_blank">linux培训</a></li>

<li><a href="http://hcymysql.blog.51cto.com/" title="" target="_blank">贺总</a></li>

<li><a href="http://gm100861.blog.51cto.com/" title="" target="_blank">吖吖呸</a></li>

<li><a href="http://litaotao.blog.51cto.com/" title="" target="_blank">litaotao</a></li>

<li><a href="http://lustlost.blog.51cto.com/2600869/1285597" title="" target="_blank">俊义</a></li>

<li><a href="http://2844337.blog.51cto.com/" title="" target="_blank">老刘博客</a></li>

<li><a href="http://djy0000.blog.51cto.com/" title="" target="_blank">邓俊阳</a></li>

<li><a href="http://opsmysql.blog.51cto.com/" title="" target="_blank">ops</a></li>

<li><a href="http://grass51.blog.51cto.com/" title="" target="_blank">My Dream</a></li>

<li><a href="http://blog.csdn.net/deansrk" title="" target="_blank">dean</a></li>

<li><a href="http://chrinux.blog.51cto.com/all/6466723/1" title="" target="_blank"> Chris</a></li>

<li><a href="http://jimmyli.blog.51cto.com/" title="" target="_blank">jimmyli</a></li>

<li><a href="http://kerry.blog.51cto.com/" title="" target="_blank">kerry</a></li>

<li><a href="http://mageedu.blog.51cto.com/" title="" target="_blank">马哥教育</a></li>

<li><a href="http://linuxxx.blog.51cto.com/all/1824808/3" title="" target="_blank">寒枫</a></li>

<li><a href="http://sery.blog.51cto.com/10037/40660" title="" target="_blank">sery</a></li>

<li><a href="http://5ydycm.blog.51cto.com/all/115934/1" title="" target="_blank">坏男孩</a> <img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/tubiao1.gif" alt="本日内更新"></li>

<li><a href="http://dl528888.blog.51cto.com/all/2382721" title="" target="_blank">邓磊</a> <img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/tubiao3.gif" alt="本周内更新"></li>

<li><a href="http://freeze.blog.51cto.com/1846439/677348" title="" target="_blank">夜的博客</a></li>

<li><a href="http://51ctoblog.blog.51cto.com/" title="51CTO博客开发" target="_blank">51CTO博客开发</a></li>

</ul>
</div><!--modCon end-->
<span class="modBot"></span>
</div>



</div>
<!--left end-->

<script type="text/javascript">
    var favor_url = "http://freeloda.blog.51cto.com/2033581/1274533";
    var favor_title = "Linux 高可用（HA）集群之Pacemaker详解";
    var favor_fuid = "2033581";
</script>
<script type="text/javascript" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/favorbox.js"></script>


<div class="blogRight" rel="2033581######HA 高可用集群 Pacemaker详解 crmsh" id="article_edu_void">
<input type="hidden" value="12" id="edu_jia">
			
	<p style="clear:both;" class="edu_insert"><div class="box edu-col-a" style="display:none;"><div class="title">的视频课程</div><div class="vbox" style=""><div class="clear hr10"></div></div></div><div class="box edu-col-b" style=""><div class="title"><a target="_blank" href="http://edu.51cto.com/index.php?do=search&m=course&q=HA">相关视频课程</a><a href="http://edu.51cto.com/index.php?do=search&m=course&q=HA" target="_blank" style="float:right;">更多</a></div><div class="vbox" style=""><div class="vlist video-icon" style="margin: 2px 8px;"><a href="http://edu.51cto.com/course/course_id-3330.html?edu_recommend_adid=91" target="_blank"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/wKioL1UTkVfAjT1BAAGK_wXrfs8754.jpg" height="63" width="86"></a><dl><dt> <a href="http://edu.51cto.com/course/course_id-3330.html?edu_recommend_adid=91" target="_blank" title="Corosync+Pacemaker+Crmsh+NFS最大化可用性集群视频课程[张彬录制]">Corosync+Pacemaker+Crmsh+NFS最大化可用性集群视频课程[张彬录制](共6课时)</a></dt><dd>105人学习</dd></dl><a class="i_video" href="http://edu.51cto.com/course/course_id-3330.html?edu_recommend_adid=91" target="_blank"></a></div><div class="vlist video-icon" style="margin: 2px 8px;"><a href="http://edu.51cto.com/course/course_id-528.html?edu_recommend_adid=91" target="_blank"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/wKiom1RW6CnwTjOHAAETyF2_KsE976.jpg" height="63" width="86"></a><dl><dt> <a href="http://edu.51cto.com/course/course_id-528.html?edu_recommend_adid=91" target="_blank" title="Linux运维那些事儿―【玩转Linux集群】">Linux运维那些事儿―【玩转Linux集群】(共32课时)</a></dt><dd>5669人学习</dd></dl><a class="i_video" href="http://edu.51cto.com/course/course_id-528.html?edu_recommend_adid=91" target="_blank"></a></div><div class="vlist video-icon" style="margin: 2px 8px;"><a href="http://edu.51cto.com/course/course_id-3149.html?edu_recommend_adid=91" target="_blank"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/wKiom1Tuuw3AP5ToAADjM4Hp0aY850.jpg" height="63" width="86"></a><dl><dt> <a href="http://edu.51cto.com/course/course_id-3149.html?edu_recommend_adid=91" target="_blank" title="Linux Heartbeat高可用集群视频课程">Linux Heartbeat高可用集群视频课程(共6课时)</a></dt><dd>365人学习</dd></dl><a class="i_video" href="http://edu.51cto.com/course/course_id-3149.html?edu_recommend_adid=91" target="_blank"></a></div><div class="clear hr10"></div></div></div></p>
	<style type="text/css">
.vlist {
    float: left;
    padding: 2px 0 0 10px;
    width: 218px;
	
}
.vlist img {
    float: left;
    margin-right: 10px;
}
.vlist dl {
    float: left;
    text-align: left;
    width: 122px;
}
.vlist dl dt {
    height: 44px;
    overflow: hidden;
    padding-top: 5px;
}
.vlist dl dt, .vlist dl dt a {
    color: #262626;
}
.vlist dl dd, .vlist dl dd a {
    color: #777777;
}
.vbox_tit {
    border-bottom: 1px solid #B3D0E6;
    color: #666666;
    font-size: 14px;
    margin-top: 10px;
    text-align: left;
}
.video-icon {
    position: relative;
}
.video-icon a.i_video {
    background: url("http://www.51cto.com/images/homepage/Images/eduplay.png") repeat scroll 0 0 rgba(0, 0, 0, 0);
    display: block;
    height: 25px;
    left: 41px;
    position: absolute;
    top: 22px;
    width: 25px;
    z-index: 10;
}
.vbox2 .vlist1{margin:0;}
.edu-col-a{ float:left;margin-right:6px;}
.edu-col-b{ float:left;}
	</style><!--modCon end-->
	<div class="artShow box" style="margin-top:5px;">
   	  <div class="share" id="share">

    <div class="shareItem">
		<div class="m_sharelinks"><a target="_blank" href="" style="color:red;"></a><a target="_blank" href="" style="color:blue;"></a><a target="_blank" href="" style="color:blue;"></a></div>
		<p class="shareMored"><a href="http://freeloda.blog.51cto.com/all/2033581">博主的更多文章&gt;&gt;</a></p>
	</div>
      </div>
       <div class="modCon">
   	  <div class="showBox" style="margin:0 0 10px;">
      <div class="line_hd_r"></div>
      <div class="art_tj">

      <a href="http://blog.51cto.com/artcommend" target="_blank"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/tj.png"></a>

      </div>

 
    		<div class="showHead">
    		  <div class="showTitleBOx" style="text-align:center">
              <div class="showTitle">

             <img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/artType01.jpg">


    		    Linux 高可用（HA）集群之Pacemaker详解
                </div>
  		    </div>
   		    <span class="artTime">2013-08-15 17:26:42</span></div><!--showHead end-->
    <div class="showTags">标签：<a href="http://blog.51cto.com/tag-HA.html" target="_blank" class="operlink">HA</a> <a href="http://blog.51cto.com/tag-%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4.html" target="_blank" class="operlink">高可用集群</a> <a href="http://blog.51cto.com/tag-Pacemaker%E8%AF%A6%E8%A7%A3.html" target="_blank" class="operlink">Pacemaker详解</a> <a href="http://blog.51cto.com/tag-crmsh.html" target="_blank" class="operlink">crmsh</a>

	</div>

			<div class="CopyrightStatement lh22">
            原创作品，允许转载，转载时请务必以超链接形式标明文章 <a href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客.html" target="_blank" style="text-decoration:underline">原始出处</a> 、作者信息和本声明。否则将追究法律责任。<a href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客.html">http://freeloda.blog.51cto.com/2033581/1274533</a>
            </div>


            <!--正文 begin-->
    		<div class="showContent">
    		  <p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">大纲</span></p><blockquote><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">说明：本来我不想写这篇博文的，因为前几篇博文都有介绍pacemaker，但是我觉得还是得写一下，试想应该会有博友需要，特别是pacemaker 1.1.8（CentOS 6.4）以后，pacemaker 有些特别要注意的变化 ，最后想说，敬开源，敬开源精神。（pacemaker官方网站：</span><a target="\&quot;_blank\&quot;" href="http://clusterlabs.org/" style="font-family:arial, helvetica, sans-serif;text-decoration:underline;"><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">http://clusterlabs.org/</span></a><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">）</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">一、pacemaker 是什么</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">二、pacemaker 特点</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">三、pacemaker 软件包供应商</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">四、pacemaker 版本信息</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">五、pacemaker 配置案例</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">六、pacemaker 支持集群架构</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">七、pacemaker 内部结构</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">八、pacemaker 源代码组成</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">九、Centos6.4+Corosync+Pacemaker 实现高可用的Web集群</span></p><p><br></p></blockquote><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">一、pacemaker 是什么</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">1.pacemaker 简单说明 </span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;"> &nbsp; &nbsp;pacemaker(直译：心脏起搏器)，是一个群集资源管理器。它实现最大可用性群集服务（亦称资源管理）的节点和资源级故障检测和恢复使用您的首选集群基础设施（OpenAIS的或Heaerbeat）提供的消息和成员能力。</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;"> &nbsp; &nbsp;它可以做乎任何规模的集群，并配备了一个强大的依赖模型，使管理员能够准确地表达群集资源之间的关系（包括顺序和位置）。几乎任何可以编写脚本，可以管理作为心脏起搏器集群的一部分。</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;"> &nbsp; &nbsp;我再次说明一下，pacemaker是个资源管理器，不是提供心跳信息的，因为它似乎是一个普遍的误解，也是值得的。pacemaker是一个延续的CRM（亦称Heartbeat V2资源管理器），最初是为心跳，但已经成为独立的项目。</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">2.pacemaker 由来</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">大家都知道，Heartbeat 到了V3版本后，拆分为多个项目，其中pacemaker就是拆分出来的资源管理器。</span></p><ul style="list-style-type:disc;" class=" list-paddingleft-2"><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Heartbeat 3.0拆分之后的组成部分：</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Heartbeat：将原来的消息通信层独立为heartbeat项目，新的heartbeat只负责维护集群各节点的信息以及它们之前通信；</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Cluster Glue：相当于一个中间层，它用来将heartbeat和pacemaker关联起来，主要包含2个部分，即为LRM和STONITH。</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Resource Agent：用来控制服务启停，监控服务状态的脚本集合，这些脚本将被LRM调用从而实现各种资源启动、停止、监控等等。</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Pacemaker : 也就是Cluster Resource Manager （简称CRM），用来管理整个HA的控制中心，客户端通过pacemaker来配置管理监控整个集群。</span></p></li></ul><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558773KYek.gif"><img onload="if(this.width&gt;650) this.width=650;" title="组成结构" style="border-left- 0px;border-right-width:0px;background-image:none;border-bottom-width:0px;border-top-width:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="组成结构" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_1376558773mAM0.gif" width="605" height="343" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload=""></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">二、pacemaker 特点</span></p><ul style="list-style-type:disc;" class=" list-paddingleft-2"><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">主机和应用程序级别的故障检测和恢复 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">几乎支持任何冗余配置 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">同时支持多种集群配置模式 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">配置策略处理法定人数损失（多台机器失败时） </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">支持应用启动/关机顺序 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">支持，必须/必须在同一台机器上运行的应用程序 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">支持多种模式的应用程序（如主/从） </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">可以测试任何故障或群集的群集状态 </span></p></li></ul><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">注：说白了意思就是功能强大，现在最主流的资源管理器。</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">三、pacemaker 软件包供应商</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">目前pacemaker支持主流的操作系统，</span></p><ul style="list-style-type:disc;" class=" list-paddingleft-2"><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Fedora（12.0） </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">红帽企业Linux（5.0，6.0） </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">openSUSE（11.0） </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Debian </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Ubuntu的LTS（10.4） </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">CentOS (5.0，6.0) </span></p></li></ul><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">四、pacemaker 版本信息</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558773hch2.png"><img onload="if(this.width&gt;650) this.width=650;" title="pacemaker 版本信息" style="border-left- 0px;border-right-width:0px;background-image:none;border-bottom-width:0px;border-top-width:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="pacemaker 版本信息" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_1376558773RHkV.png" width="650" height="242" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload=""></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">目前，最新版的是pacemaker 1.1.10 ，是2013年7月发布的</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">五、pacemaker 配置案例</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">1.主/从架构</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">说明：许多高可用性的情况下，使用Pacemaker和DRBD的双节点主/从集群是一个符合成本效益的解决方案。</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558774B0Bp.png"><img onload="if(this.width&gt;650) this.width=650;" title="Pacemaker-active-passive" style="border-left- 0px;border-right-width:0px;background-image:none;border-bottom-width:0px;border-top-width:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="Pacemaker-active-passive" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_1376558776FMFe.png" width="650" height="600" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload=""></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">2.多节点备份集群</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">说明：支持多少节点，Pacemaker可以显着降低硬件成本通过允许几个主/从群集要结合和共享一个公用备份节点。</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558777cikv.png"><img onload="if(this.width&gt;650) this.width=650;" title="Pacemaker-n-plus-1" style="border-left- 0px;border-right-width:0px;background-image:none;border-bottom-width:0px;border-top-width:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="Pacemaker-n-plus-1" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_137655877903zD.png" width="650" height="600" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload=""></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">3.共享存储集群</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">说明：有共享存储时，每个节点可能被用于故障转移。Pacemaker甚至可以运行多个服务。</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_137655878000O4.png"><img onload="if(this.width&gt;650) this.width=650;" title="Pacemaker-n-to-n" style="border-left- 0px;border-right-width:0px;background-image:none;border-bottom-width:0px;border-top-width:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="Pacemaker-n-to-n" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_1376558782kakh.png" width="650" height="600" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload=""></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">4.站点集群</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">说明：Pacemaker 1.2 将包括增强简化设立分站点集群</span></p><p><a target="_blank" href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/172932503.png"><img onload="if(this.width&gt;650) this.width=650;" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/172932503.png" title="Pacemaker-split-site.png" width="650" height="602" border="0" hspace="0" vspace="0" style="width:800px;height:602px;" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload=""></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">六、pacemaker 支持集群</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">1.基于OpenAIS的集群</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558786N3UV.png"><img onload="if(this.width&gt;650) this.width=650;" title="crm5" style="border-left- 0px;border-right-width:0px;background-image:none;border-bottom-width:0px;border-top-width:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="crm5" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_1376558787pJ7Y.png" width="650" height="600" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload=""></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">2.传统集群架构，基于心跳信息</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558789MeBa.png"><img onload="if(this.width&gt;650) this.width=650;" title="crm6" style="border-left- 0px;border-right-width:0px;background-image:none;border-bottom-width:0px;border-top-width:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="crm6" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_137655879073RU.png" width="650" height="600" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload=""></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">七、pacemaker 内部结构</span></p><p><a target="_blank" href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/173114759.png"><img onload="if(this.width&gt;650) this.width=650;" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/173114759.png" title="crm7.png" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload="" width="650"></a></p><p><a target="\&quot;_blank\&quot;" name="Cluster_Components"></a></p><h6><span style="font-size:14px;font-family:arial, helvetica, sans-serif;">1.群集组件说明：</span></h6><ul style="list-style-type:disc;" class=" list-paddingleft-2"><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">stonithd：心跳系统。 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">lrmd：</span><em><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">本地资源管理守护进程</span></em><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">。它提供了一个通用的接口支持的资源类型。直接调用资源代理（脚本）。 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">pengine：</span><em><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">政策引擎</span></em><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">。根据当前状态和配置集群计算的下一个状态。产生一个过渡图，包含行动和依赖关系的列表。 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">CIB：</span><em><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">群集信息库</span></em><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">。包含所有群集选项，节点，资源，他们彼此之间的关系和现状的定义。同步更新到所有群集节点。 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">CRMD：</span><em><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">集群资源管理守护进程</span></em><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">。主要是消息代理的PEngine和LRM，还选举一个领导者（DC）统筹活动（包括启动/停止资源）的集群。 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">OpenAIS：OpenAIS的消息和成员层。 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Heartbeat：心跳消息层，OpenAIS的一种替代。 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">CCM：</span><em><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">共识群集成员，</span></em><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">心跳成员层。 </span></p></li></ul><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">2.功能概述</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;"> &nbsp; &nbsp;CIB使用XML表示集群的集群中的所有资源的配置和当前状态。CIB的内容会被自动在整个集群中同步，使用PEngine计算集群的理想状态，生成指令列表，然后输送到DC（指定协调员）。Pacemaker 集群中所有节点选举的DC节点作为主决策节点。如果当选DC节点宕机，它会在所有的节点上， 迅速建立一个新的DC。DC将PEngine生成的策略，传递给其他节点上的LRMd（本地资源管理守护程序）或CRMD通过集群消息传递基础结构。当集群中有节点宕机，PEngine重新计算的理想策略。在某些情况下，可能有必要关闭节点，以保护共享数据或完整的资源回收。为此，Pacemaker配备了stonithd设备。STONITH可以将其它节点“爆头”，通常是实现与远程电源开关。Pacemaker会将STONITH设备，配置为资源保存在CIB中，使他们可以更容易地监测资源失败或宕机。</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">八、pacemaker 源代码组成</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558793nvRc.png"><img onload="if(this.width&gt;650) this.width=650;" title="crm8" style="border-left- 0px;border-right-width:0px;background-image:none;border-bottom-width:0px;border-top-width:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="crm8" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_1376558794VJ1k.png" width="424" height="256" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload=""></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">说明：大家可以看到Pacemaker主要是由C语言写的，其次是Python，说明其效率非常高。最后我们来说一个小案例，实现高可用的Web集群。</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">九、Centos6.4+Corosync+Pacemaker 实现高可用的Web集群</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">1.环境说明</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(1).操作系统</span></p><ul style="list-style-type:disc;" class=" list-paddingleft-2"><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">CentOS 6.4 X86_64 位系统 </span></p></li></ul><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(2).软件环境</span></p><ul style="list-style-type:disc;" class=" list-paddingleft-2"><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Corosync 1.4.1</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Pacemaker 1.1.8 </span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">crmsh 1.2.6</span></p></li></ul><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(3).拓扑准备</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558794D34V.png"><img onload="if(this.width&gt;650) this.width=650;" title="HA Web 拓扑" style="border-top:0px;border-right:0px;background-image:none;border-bottom:0px;border-left:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="HA Web 拓扑" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_1376558794OW5g.png" height="462" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload="" width="650"></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">2.Corosync与Pacemaker 安装与配置</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Corosync与Pacemaker安装与配置我就不在这里重复说明了，大家参考一下这篇博文：</span><a target="\&quot;_blank\&quot;" title="http://freeloda.blog.51cto.com/2033581/1272417" href="http://freeloda.blog.51cto.com/2033581/1272417" style="font-family:arial, helvetica, sans-serif;text-decoration:underline;"><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">http://freeloda.blog.51cto.com/2033581/1272417</span></a><span style="font-family:arial, helvetica, sans-serif;font-size:14px;"> （Linux 高可用（HA）集群之Corosync详解）</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">3.Pacemaker 配置资源方法</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(1).命令配置方式</span></p><ul style="list-style-type:disc;" class=" list-paddingleft-2"><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">crmsh</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">pcs</span></p></li></ul><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(2).图形配置方式</span></p><ul style="list-style-type:disc;" class=" list-paddingleft-2"><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">pygui</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">hawk</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">LCMC</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">pcs</span></p></li></ul><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">注：本文主要的讲解的是crmsh</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">4.crmsh 简单说明 </span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">注：以下上pacemaker 1.1.8的更新说明，最重要的我用红色标记出来，</span><span style="color:#FF0000;font-family:arial, helvetica, sans-serif;font-size:14px;">从pacemaker 1.1.8开始，crm sh 发展成一个独立项目，pacemaker中不再提供</span><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">，说明我们安装好pacemaker后，是不会有crm这个命令行模式的资源管理器的。</span></p><div><div id="highlighter_449192" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># cd /usr/share/doc/pacemaker-1.1.8/ </code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@node1 pacemaker-1.1.8]</code><code class="bash comments"># ll&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">总用量 132&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">-rw-r--r-- 1 root root&nbsp;&nbsp; 1102 2月&nbsp; 22 13:05 AUTHORS&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">-rw-r--r-- 1 root root 109311 2月&nbsp; 22 13:05 ChangeLog&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">-rw-r--r-- 1 root root&nbsp; 18046 2月&nbsp; 22 13:05 COPYING&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">[root@node1 pacemaker-1.1.8]</code><code class="bash comments"># vim ChangeLog</code></div><div class="line number8 index7 alt1"><code class="bash plain">* Thu Sep 20 2012 Andrew Beekhof &lt;andrew@beekhof.net&gt; Pacemaker-1.1.8-1</code></div><div class="line number9 index8 alt2"><code class="bash plain">- Update </code><code class="bash functions">source</code> <code class="bash plain">tarball to revision: 1a5341f </code></div><div class="line number10 index9 alt1"><code class="bash plain">- Statistics:&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">Changesets: 1019&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;</code><code class="bash plain">Diff:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2107 files changed, 117258 insertions(+), 73606 deletions(-)</code></div><div class="line number13 index12 alt2"><code class="bash plain">- All APIs have been cleaned up and reduced to essentials </code></div><div class="line number14 index13 alt1"><code class="bash plain">- Pacemaker now includes a replacement lrmd that supports systemd and upstart agents&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash plain">- Config and state files (cib.xml, PE inputs and core files) have moved to new locations&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash plain">- The crm shell has become a separate project and no longer included with Pacemaker （crm shell 已成为一个独立的项目,pacemaker中一再提供）</code></div><div class="line number17 index16 alt2"><code class="bash plain">- All daemons</code><code class="bash plain">/tools</code> <code class="bash plain">now have a unified </code><code class="bash functions">set</code> <code class="bash plain">of error codes based on errno.h (see crm_error)</code></div><div class="line number18 index17 alt1"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># crm </code></div><div class="line number19 index18 alt2"><code class="bash plain">crmadmin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crm_diff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crm_failcount&nbsp; crm_mon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crm_report&nbsp;&nbsp;&nbsp;&nbsp; crm_shadow&nbsp;&nbsp;&nbsp;&nbsp; crm_standby&nbsp;&nbsp;&nbsp; crm_verify&nbsp; </code></div><div class="line number20 index19 alt1"><code class="bash plain">crm_attribute&nbsp; crm_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crm_master&nbsp;&nbsp;&nbsp;&nbsp; crm_node&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crm_resource&nbsp;&nbsp; crm_simulate&nbsp;&nbsp; crm_ticket</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">注：大家可以看到，安装好pacemaker后，就没有crm shell命令行工具，我们得单独安装。下面我们就来说说怎么安装crm sh</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">5.安装crmsh资源管理工具</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(1).crmsh官方网站</span></p><p><a target="\&quot;_blank\&quot;" title="https://savannah.nongnu.org/forum/forum.php?forum_id=7672" href="https://savannah.nongnu.org/forum/forum.php?forum_id=7672" style="font-family:arial, helvetica, sans-serif;text-decoration:underline;"><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">https://savannah.nongnu.org/forum/forum.php?forum_id=7672</span></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(2).crmsh下载地址</span></p><p><a target="\&quot;_blank\&quot;" title="http://download.opensuse.org/repositories/network:/ha-clustering:/Stable/" href="http://download.opensuse.org/repositories/network:/ha-clustering:/Stable/" style="font-family:arial, helvetica, sans-serif;text-decoration:underline;"><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">http://download.opensuse.org/repositories/network:/ha-clustering:/Stable/</span></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(3).安装crmsh</span></p><div><div id="highlighter_867163" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># rpm -ivh crmsh-1.2.6-0.rc2.2.1.x86_64.rpm&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">warning: crmsh-1.2.6-0.rc2.2.1.x86_64.rpm: Header V3 DSA</code><code class="bash plain">/SHA1</code> <code class="bash plain">Signature, key ID 7b709911: NOKEY&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">error: Failed dependencies:&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">pssh is needed by crmsh-1.2.6-0.rc2.2.1.x86_64&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">python-dateutil is needed by crmsh-1.2.6-0.rc2.2.1.x86_64&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">python-lxml is needed by crmsh-1.2.6-0.rc2.2.1.x86_64</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">注：大家可以看到年缺少依赖包，我们先用yum安装依赖包</span></p><div><div id="highlighter_963972" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># yum install -y python-dateutil python-lxml</code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># rpm -ivh crmsh-1.2.6-0.rc2.2.1.x86_64.rpm --nodeps </code></div><div class="line number3 index2 alt2"><code class="bash plain">warning: crmsh-1.2.6-0.rc2.2.1.x86_64.rpm: Header V3 DSA</code><code class="bash plain">/SHA1</code> <code class="bash plain">Signature, key ID 7b709911: NOKEY&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">Preparing...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="bash comments">########################################### [100%]&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;</code><code class="bash plain">1:crmsh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="bash comments">########################################### [100%]</code></div><div class="line number6 index5 alt1"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># crm #安装好后出现一个crm命令，说明安装完成 </code></div><div class="line number7 index6 alt2"><code class="bash plain">crm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crm_attribute&nbsp; crm_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crm_master&nbsp;&nbsp;&nbsp;&nbsp; crm_node&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crm_resource&nbsp;&nbsp; crm_simulate&nbsp;&nbsp; crm_ticket&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">crmadmin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crm_diff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crm_failcount&nbsp; crm_mon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crm_report&nbsp;&nbsp;&nbsp;&nbsp; crm_shadow&nbsp;&nbsp;&nbsp;&nbsp; crm_standby&nbsp;&nbsp;&nbsp; crm_verify&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># crm #输入crm命令，进入资源配置模式&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash plain">Cannot change active directory to </code><code class="bash plain">/var/lib/pacemaker/cores/root</code><code class="bash plain">: No such </code><code class="bash functions">file</code> <code class="bash plain">or directory (2)&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># help #查看一下帮助</code></div><div class="line number12 index11 alt1"><code class="bash plain">This is crm shell, a Pacemaker </code><code class="bash functions">command</code> <code class="bash plain">line interface.</code></div><div class="line number13 index12 alt2"><code class="bash plain">Available commands:</code></div><div class="line number14 index13 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cib&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; manage shadow CIBs </code></div><div class="line number15 index14 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">resource&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resources management&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">configure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CRM cluster configuration&nbsp; </code></div><div class="line number17 index16 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">node&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nodes management&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">options&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; user preferences&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">history</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="bash plain">CRM cluster </code><code class="bash functions">history</code>&nbsp;</div><div class="line number20 index19 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">site&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Geo-cluster support&nbsp; </code></div><div class="line number21 index20 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">ra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resource agents information center&nbsp; </code></div><div class="line number22 index21 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; show cluster status&nbsp; </code></div><div class="line number23 index22 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">help,?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; show help (help topics </code><code class="bash keyword">for</code> <code class="bash plain">list of topics)&nbsp; </code></div><div class="line number24 index23 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">end,</code><code class="bash functions">cd</code><code class="bash plain">,up&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; go back one level&nbsp; </code></div><div class="line number25 index24 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">quit,bye,</code><code class="bash functions">exit</code>&nbsp;&nbsp;&nbsp; <code class="bash functions">exit</code> <code class="bash plain">the program&nbsp; </code></div><div class="line number26 index25 alt1"><code class="bash plain">crm(live)</code><code class="bash comments">#</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">注：到此准备工作全部完成，下面我们来具体配置一下高可用的Web集群，在配置之前我们还得简的说明一下，crm sh 如何使用！</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">6.crmsh使用说明</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">注：简单说明一下，其实遇到一个新命令最好的方法就是man一下！简单的先熟悉一下这个命令，然后再慢慢尝试。</span></p><div><div id="highlighter_414657" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># crm #输入crm命令，进入crm&nbsp; sh 模式 </code></div><div class="line number2 index1 alt1"><code class="bash plain">Cannot change active directory to </code><code class="bash plain">/var/lib/pacemaker/cores/root</code><code class="bash plain">: No such </code><code class="bash functions">file</code> <code class="bash plain">or directory (2)&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># help #输入help查看一下，会出下很多子命令</code></div><div class="line number4 index3 alt1"><code class="bash plain">This is crm shell, a Pacemaker </code><code class="bash functions">command</code> <code class="bash plain">line interface.</code></div><div class="line number5 index4 alt2"><code class="bash plain">Available commands:</code></div><div class="line number6 index5 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cib&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; manage shadow CIBs </code></div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">resource&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resources management&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">configure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CRM cluster configuration</code></div><div class="line number9 index8 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">node&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nodes management&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">options&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; user preferences&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">history</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="bash plain">CRM cluster </code><code class="bash functions">history</code>&nbsp;</div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">site&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Geo-cluster support&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">ra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resource agents information center&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; show cluster status&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">help,?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; show help (help topics </code><code class="bash keyword">for</code> <code class="bash plain">list of topics)&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">end,</code><code class="bash functions">cd</code><code class="bash plain">,up&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; go back one level&nbsp; </code></div><div class="line number17 index16 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">quit,bye,</code><code class="bash functions">exit</code>&nbsp;&nbsp;&nbsp; <code class="bash functions">exit</code> <code class="bash plain">the program&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash plain">crm(live)</code><code class="bash comments"># configure #输入configure就会进入，configure模式下，&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># #敲两下tab键就会显示configure下全部命令&nbsp;&nbsp; </code></div><div class="line number20 index19 alt1"><code class="bash plain">?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default-timeouts&nbsp;&nbsp; group&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; node&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; simulate&nbsp;&nbsp; </code></div><div class="line number21 index20 alt2"><code class="bash plain">bye&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delete&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; op_defaults&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; role&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; template&nbsp;&nbsp; </code></div><div class="line number22 index21 alt1"><code class="bash functions">cd</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="bash plain">edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="bash functions">history</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="bash plain">order&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rsc_defaults&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; up&nbsp;&nbsp; </code></div><div class="line number23 index22 alt2"><code class="bash plain">cib&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; load&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; primitive&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rsc_template&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; upgrade&nbsp;&nbsp; </code></div><div class="line number24 index23 alt1"><code class="bash plain">cibstatus&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; erase&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; property&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rsc_ticket&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; user&nbsp;&nbsp; </code></div><div class="line number25 index24 alt2"><code class="bash plain">clone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="bash functions">exit</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="bash plain">master&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ptest&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rsctest&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; verify&nbsp;&nbsp; </code></div><div class="line number26 index25 alt1"><code class="bash plain">collocation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fencing_topology&nbsp;&nbsp; modgroup&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xml&nbsp;&nbsp; </code></div><div class="line number27 index26 alt2"><code class="bash plain">colocation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; monitor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; schema&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number28 index27 alt1"><code class="bash plain">commit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; graph&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ms&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; refresh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; show&nbsp; </code></div><div class="line number29 index28 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># help node #输入help加你想了解的任意命令，就会显示该命令的使用帮助与案例</code></div><div class="line number30 index29 alt1"><code class="bash plain">The node </code><code class="bash functions">command</code> <code class="bash plain">describes a cluster node. Nodes </code><code class="bash keyword">in</code> <code class="bash plain">the CIB are </code></div><div class="line number31 index30 alt2"><code class="bash plain">commonly created automatically by the CRM. Hence, you should not&nbsp; </code></div><div class="line number32 index31 alt1"><code class="bash plain">need to deal with nodes unless you also want to define node&nbsp; </code></div><div class="line number33 index32 alt2"><code class="bash plain">attributes. Note that it is also possible to manage node&nbsp; </code></div><div class="line number34 index33 alt1"><code class="bash plain">attributes at the `node` level.</code></div><div class="line number35 index34 alt2"><code class="bash plain">Usage: </code></div><div class="line number36 index35 alt1"><code class="bash plain">...............&nbsp; </code></div><div class="line number37 index36 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">node &lt;</code><code class="bash functions">uname</code><code class="bash plain">&gt;[:&lt;</code><code class="bash functions">type</code><code class="bash plain">&gt;]&nbsp; </code></div><div class="line number38 index37 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">[attributes &lt;param&gt;=&lt;value&gt; [&lt;param&gt;=&lt;value&gt;...]]&nbsp; </code></div><div class="line number39 index38 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">[utilization &lt;param&gt;=&lt;value&gt; [&lt;param&gt;=&lt;value&gt;...]]</code></div><div class="line number40 index39 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">type</code> <code class="bash plain">:: normal | member | </code><code class="bash functions">ping</code></div><div class="line number41 index40 alt2"><code class="bash plain">...............&nbsp; </code></div><div class="line number42 index41 alt1"><code class="bash plain">Example:&nbsp; </code></div><div class="line number43 index42 alt2"><code class="bash plain">...............&nbsp; </code></div><div class="line number44 index43 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">node node1&nbsp; </code></div><div class="line number45 index44 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">node big_node attributes memory=64&nbsp; </code></div><div class="line number46 index45 alt1"><code class="bash plain">...............</code></div><div class="line number47 index46 alt2"><code class="bash plain">注：好了，简单说明就到这，其实就是一句话，不会的命令help一下。下面我们开始配置，高可用的Web集群。</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">7.crmsh 配置高可用的Web集群</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;"> (1).查看一下默认配置</span></p><div><div id="highlighter_266493" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># crm </code></div><div class="line number2 index1 alt1"><code class="bash plain">Cannot change active directory to </code><code class="bash plain">/var/lib/pacemaker/cores/root</code><code class="bash plain">: No such </code><code class="bash functions">file</code> <code class="bash plain">or directory (2)&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># configure&nbsp;&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(2).检测一下配置文件是否有错</span></p><div><div id="highlighter_739325" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># configure&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># verify</code></div><div class="line number3 index2 alt2"><code class="bash plain">crm_verify[5202]: 2011</code><code class="bash plain">/06/14_19</code><code class="bash plain">:10:38 ERROR: unpack_resources: Resource start-up disabled since no STONITH resources have been defined </code></div><div class="line number4 index3 alt1"><code class="bash plain">crm_verify[5202]: 2011</code><code class="bash plain">/06/14_19</code><code class="bash plain">:10:38 ERROR: unpack_resources: Either configure some or disable STONITH with the stonith-enabled option&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">crm_verify[5202]: 2011</code><code class="bash plain">/06/14_19</code><code class="bash plain">:10:38 ERROR: unpack_resources: NOTE: Clusters with shared data need STONITH to ensure data integrity&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">注：说我们的STONITH resources没有定义，因我们这里没有STONITH设备，所以我们先关闭这个属性</code></div><div class="line number7 index6 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># property stonith-enabled=false</code></div><div class="line number8 index7 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show </code></div><div class="line number9 index8 alt2"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code></div><div class="line number16 index15 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># verify&nbsp; #现在已经不报错</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(3).查看当前集群系统所支持的类型</span></p><div><div id="highlighter_992135" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># ra </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)ra</code><code class="bash comments"># classes&nbsp;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">lsb&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">ocf / heartbeat pacemaker redhat&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">service&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">stonith</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(4).查看某种类别下的所用资源代理的列表</span></p><div><div id="highlighter_243552" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)ra</code><code class="bash comments"># list lsb </code></div><div class="line number2 index1 alt1"><code class="bash plain">auditd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; blk-availability&nbsp;&nbsp;&nbsp; corosync&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; corosync-notifyd&nbsp;&nbsp;&nbsp; crond&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; halt&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">htcacheclean&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; httpd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ip6tables&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iptables&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; killall&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvm2-lvmetad&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">lvm2-monitor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messagebus&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; netconsole&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; netfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; network&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nfs&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">nfslock&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ntpd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ntpdate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pacemaker&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; postfix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quota_nld&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">rdisc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; restorecond&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rpcbind&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rpcgssd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rpcidmapd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rpcsvcgssd&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">rsyslog&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sandbox&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; saslauthd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; single&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sshd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; svnserve&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">udev-post&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; winbind&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash plain">crm(live)ra</code><code class="bash comments"># list ocf heartbeat </code></div><div class="line number10 index9 alt1"><code class="bash plain">AoEtarget&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AudibleAlarm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CTDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ClusterMon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Delay&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dummy&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash plain">EvmsSCC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Evmsd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Filesystem&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ICP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IPaddr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IPaddr2&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash plain">IPsrcaddr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IPv6addr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LVM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LinuxSCSI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MailTo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ManageRAID&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash plain">ManageVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pure-FTPd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Raid1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Route&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SAPDatabase&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SAPInstance&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash plain">SendArp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ServeRAID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SphinxSearchDaemon&nbsp; Squid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Stateful&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SysInfo&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash plain">VIPArip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VirtualDomain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WAS6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WinPopup&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Xen&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash plain">Xinetd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anything&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; apache&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conntrackd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; db2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; drbd&nbsp; </code></div><div class="line number17 index16 alt2"><code class="bash plain">eDir88&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ethmonitor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exportfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fio&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iSCSILogicalUnit&nbsp;&nbsp;&nbsp; iSCSITarget&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash plain">ids&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iscsi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jboss&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lxc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mysql&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mysql-proxy&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash plain">nfsserver&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nginx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oracle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oralsnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pgsql&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pingd&nbsp; </code></div><div class="line number20 index19 alt1"><code class="bash plain">portblock&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; postfix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; proftpd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rsyncd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scsi2reservation&nbsp;&nbsp;&nbsp; sfex&nbsp; </code></div><div class="line number21 index20 alt2"><code class="bash functions">symlink</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="bash plain">syslog-ng&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tomcat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vmware&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number22 index21 alt1"><code class="bash plain">crm(live)ra</code><code class="bash comments"># list ocf pacemaker </code></div><div class="line number23 index22 alt2"><code class="bash plain">ClusterMon&nbsp;&nbsp;&nbsp;&nbsp; Dummy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HealthCPU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HealthSMART&nbsp;&nbsp;&nbsp; Stateful&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SysInfo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SystemHealth&nbsp;&nbsp; controld&nbsp; </code></div><div class="line number24 index23 alt1"><code class="bash plain">o2cb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="bash functions">ping</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="bash plain">pingd</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(5).查看某个资源代理的配置方法</span></p><div><div id="highlighter_398897" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)ra</code><code class="bash comments"># info ocf:heartbeat:IPaddr</code></div><div class="line number2 index1 alt1"><code class="bash plain">Manages virtual IPv4 addresses (portable version) (ocf:heartbeat:IPaddr)</code></div><div class="line number3 index2 alt2"><code class="bash plain">This script manages IP </code><code class="bash functions">alias</code> <code class="bash plain">IP addresses </code></div><div class="line number4 index3 alt1"><code class="bash plain">It can add an IP </code><code class="bash functions">alias</code><code class="bash plain">, or remove one.</code></div><div class="line number5 index4 alt2"><code class="bash plain">Parameters (* denotes required, [] the default):</code></div><div class="line number6 index5 alt1"><code class="bash plain">ip* (string): IPv4 address </code></div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">The IPv4 address to be configured </code><code class="bash keyword">in</code> <code class="bash plain">dotted quad notation, </code><code class="bash keyword">for</code> <code class="bash plain">example&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash string">"192.168.1.1"</code><code class="bash plain">.</code></div><div class="line number9 index8 alt2"><code class="bash plain">nic (string, [eth0]): Network interface </code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">The base network interface on </code><code class="bash functions">which</code> <code class="bash plain">the IP address will be brought&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">online.&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">If left empty, the script will try and determine this from the&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">routing table.&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">Do NOT specify an </code><code class="bash functions">alias</code> <code class="bash plain">interface </code><code class="bash keyword">in</code> <code class="bash plain">the form eth0:1 or anything here;&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">rather, specify the base interface only.&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">Prerequisite:&nbsp; </code></div><div class="line number17 index16 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">There must be at least one static IP address, </code><code class="bash functions">which</code> <code class="bash plain">is not managed by&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">the cluster, assigned to the network interface.&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">If you can not assign any static IP address on the interface,&nbsp; </code></div><div class="line number20 index19 alt1"><code class="bash plain">:</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(6).接下来要创建的web集群创建一个IP地址资源(IP资源是主资源，我们查看一下怎么定义一个主资源)</span></p><div><div id="highlighter_148606" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># configure&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># primitive&nbsp;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">usage: primitive &lt;rsc&gt; {[&lt;class&gt;:[&lt;provider&gt;:]]&lt;</code><code class="bash functions">type</code><code class="bash plain">&gt;|@&lt;template&gt;}&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">[params &lt;param&gt;=&lt;value&gt; [&lt;param&gt;=&lt;value&gt;...]]&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">[meta &lt;attribute&gt;=&lt;value&gt; [&lt;attribute&gt;=&lt;value&gt;...]]&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">[utilization &lt;attribute&gt;=&lt;value&gt; [&lt;attribute&gt;=&lt;value&gt;...]]&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">[operations id_spec&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">[</code><code class="bash functions">op</code> <code class="bash plain">op_type [&lt;attribute&gt;=&lt;value&gt;...] ...]]</code></div><div class="line number9 index8 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># primitive vip ocf:heartbeat:IPaddr params ip=192.168.18.200 nic=eth0 cidr_netmask=24 #增加一个VIP资源&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show #查看已增加好的VIP，我用红色标记了一下&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash plain">primitive vip ocf:heartbeat:IPaddr \&nbsp;&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params ip=</code><code class="bash string">"192.168.18.200"</code> <code class="bash plain">nic=</code><code class="bash string">"eth0"</code> <code class="bash plain">cidr_netmask=</code><code class="bash string">"24"</code></div><div class="line number15 index14 alt2"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number17 index16 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code>&nbsp;</div><div class="line number20 index19 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># verify #检查一下配置文件有没有错误&nbsp; </code></div><div class="line number21 index20 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># commit #提交配置的资源，在命令行配置资源时，只要不用commit提交配置好资源，就不会生效，一但用commit命令提交，就会写入到cib.xml的配置文件中</code></div><div class="line number22 index21 alt1"><code class="bash plain">crm(live)</code><code class="bash comments"># status #查看一下配置好的资源状态，有一个资源vip，运行在node1上 </code></div><div class="line number23 index22 alt2"><code class="bash plain">Last updated: Thu Aug 15 14:24:45 2013&nbsp; </code></div><div class="line number24 index23 alt1"><code class="bash plain">Last change: Thu Aug 15 14:21:21 2013 via cibadmin on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number25 index24 alt2"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number26 index25 alt1"><code class="bash plain">Current DC: node1.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number27 index26 alt2"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number28 index27 alt1"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number29 index28 alt2"><code class="bash plain">1 Resources configured.</code></div><div class="line number30 index29 alt1"><code class="bash plain">Online: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number31 index30 alt2"><code class="bash spaces">&nbsp;</code><code class="bash plain">vip&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;"> 查看一下node1节点上的ip，大家可以看到vip已经生效，而后我们到node2上通过如下命令停止node1上的corosync服务，再查看状态 &nbsp;<br></span></p><div><div id="highlighter_464149" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># ifconfig</code></div><div class="line number2 index1 alt1"><code class="bash plain">eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Link encap:Ethernet&nbsp; HWaddr 00:0C:29:91:45:90</code></div><div class="line number3 index2 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">inet addr:192.168.18.201&nbsp; Bcast:192.168.18.255&nbsp; Mask:255.255.255.0&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">inet6 addr: fe80::20c:29ff:fe91:4590</code><code class="bash plain">/64</code> <code class="bash plain">Scope:Link&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">RX packets:375197 errors:0 dropped:0 overruns:0 frame:0&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">TX packets:291575 errors:0 dropped:0 overruns:0 carrier:0&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">collisions:0 txqueuelen:1000&nbsp;&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">RX bytes:55551264 (52.9 MiB)&nbsp; TX bytes:52697225 (50.2 MiB)</code></div><div class="line number10 index9 alt1"><code class="bash plain">eth0:0&nbsp;&nbsp;&nbsp; Link encap:Ethernet&nbsp; HWaddr 00:0C:29:91:45:90</code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">inet addr:192.168.18.200&nbsp; Bcast:192.168.18.255&nbsp; Mask:255.255.255.0&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1</code></div><div class="line number13 index12 alt2"><code class="bash plain">lo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Link encap:Local Loopback</code></div><div class="line number14 index13 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">inet addr:127.0.0.1&nbsp; Mask:255.0.0.0&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">inet6 addr: ::1</code><code class="bash plain">/128</code> <code class="bash plain">Scope:Host&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1&nbsp; </code></div><div class="line number17 index16 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">RX packets:6473 errors:0 dropped:0 overruns:0 frame:0&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">TX packets:6473 errors:0 dropped:0 overruns:0 carrier:0&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">collisions:0 txqueuelen:0&nbsp;&nbsp; </code></div><div class="line number20 index19 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">RX bytes:875395 (854.8 KiB)&nbsp; TX bytes:875395 (854.8 KiB)</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">测试，停止node1节点上的corosync，可以看到node1已经离线</span></p><div><div id="highlighter_518369" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># ssh node1 "service corosync stop"&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">Signaling Corosync Cluster Engine (corosync) to terminate: [确定]&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">Waiting </code><code class="bash keyword">for</code> <code class="bash plain">corosync services to unload:..[确定]&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># crm status&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">Cannot change active directory to </code><code class="bash plain">/var/lib/pacemaker/cores/root</code><code class="bash plain">: No such </code><code class="bash functions">file</code> <code class="bash plain">or directory (2)&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">Last updated: Thu Aug 15 14:29:04 2013&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">Last change: Thu Aug 15 14:21:21 2013 via cibadmin on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition WITHOUT quorum&nbsp;&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash plain">1 Resources configured.</code></div><div class="line number13 index12 alt2"><code class="bash plain">Online: [ node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash plain">OFFLINE: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">重点说明：上面的信息显示node1.test.com已经离线，但资源vip却没能在node2.test.com上启动。这是因为此时的集群状态为"WITHOUT quorum"(红色标记)，即已经失去了quorum，此时集群服务本身已经不满足正常运行的条件，这对于只有两节点的集群来讲是不合理的。因此，我们可以通过如下的命令来修改忽略quorum不能满足的集群状态检查：property no-quorum-policy=ignore</span></p><div><div id="highlighter_92196" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># configure&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># property no-quorum-policy=ignore&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">primitive vip ocf:heartbeat:IPaddr \&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params ip=</code><code class="bash string">"192.168.18.200"</code> <code class="bash plain">nic=</code><code class="bash string">"eth0"</code> <code class="bash plain">cidr_netmask=</code><code class="bash string">"24"</code>&nbsp;</div><div class="line number8 index7 alt1"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">no-quorum-policy=</code><code class="bash string">"ignore"</code>&nbsp;</div><div class="line number14 index13 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># verify</code></div><div class="line number15 index14 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># commit</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">片刻之后，集群就会在目前仍在运行中的节点node2上启动此资源了，如下所示：</span></p><div><div id="highlighter_393286" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># crm status </code></div><div class="line number2 index1 alt1"><code class="bash plain">Cannot change active directory to </code><code class="bash plain">/var/lib/pacemaker/cores/root</code><code class="bash plain">: No such </code><code class="bash functions">file</code> <code class="bash plain">or directory (2)&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">Last updated: Thu Aug 15 14:38:23 2013&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">Last change: Thu Aug 15 14:37:08 2013 via cibadmin on node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition WITHOUT quorum&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash plain">1 Resources configured.</code></div><div class="line number10 index9 alt1"><code class="bash plain">Online: [ node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash plain">OFFLINE: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;</code><code class="bash plain">vip&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">好了，验正完成后，我们正常启动node1.test.com</span></p><div><div id="highlighter_864295" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># ssh node1 "service corosync start" </code></div><div class="line number2 index1 alt1"><code class="bash plain">Starting Corosync Cluster Engine (corosync): [确定]&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># crm status&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">Cannot change active directory to </code><code class="bash plain">/var/lib/pacemaker/cores/root</code><code class="bash plain">: No such </code><code class="bash functions">file</code> <code class="bash plain">or directory (2)&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">Last updated: Thu Aug 15 14:39:45 2013&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">Last change: Thu Aug 15 14:37:08 2013 via cibadmin on node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash plain">1 Resources configured.</code></div><div class="line number12 index11 alt1"><code class="bash plain">Online: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;</code><code class="bash plain">vip&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com </code></div><div class="line number14 index13 alt1"><code class="bash plain">[root@node2 ~]</code><code class="bash comments">#</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">正常启动node1.test.com后，集群资源vip很可能会重新从node2.test.com转移回node1.test.com，但也可能不回去。资源的这种在节点间每一次的来回流动都会造成那段时间内其无法正常被访问，所以，我们有时候需要在资源因为节点故障转移到其它节点后，即便原来的节点恢复正常也禁止资源再次流转回来。这可以通过定义资源的黏性(stickiness)来实现。在创建资源时或在创建资源后，都可以指定指定资源黏性。好了，下面我们来简单回忆一下，资源黏性。</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(7).资源黏性</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">资源黏性是指：资源更倾向于运行在哪个节点。</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">资源黏性值范围及其作用：</span></p><ul style="list-style-type:disc;" class=" list-paddingleft-2"><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">0：这是默认选项。资源放置在系统中的最适合位置。这意味着当负载能力“较好”或较差的节点变得可用时才转移资源。此选项的作用基本等同于自动故障回复，只是资源可能会转移到非之前活动的节点上；</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">大于0：资源更愿意留在当前位置，但是如果有更合适的节点可用时会移动。值越高表示资源越愿意留在当前位置；</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">小于0：资源更愿意移离当前位置。绝对值越高表示资源越愿意离开当前位置；</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">INFINITY：如果不是因节点不适合运行资源（节点关机、节点待机、达到migration-threshold 或配置更改）而强制资源转移，资源总是留在当前位置。此选项的作用几乎等同于完全禁用自动故障回复；</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">-INFINITY：资源总是移离当前位置；</span></p></li></ul><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">我们这里可以通过以下方式为资源指定默认黏性值： rsc_defaults resource-stickiness=100</span></p><div><div id="highlighter_226782" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># rsc_defaults resource-stickiness=100 </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># verify&nbsp;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show&nbsp;&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">primitive vip ocf:heartbeat:IPaddr \&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params ip=</code><code class="bash string">"192.168.18.200"</code> <code class="bash plain">nic=</code><code class="bash string">"eth0"</code> <code class="bash plain">cidr_netmask=</code><code class="bash string">"24"</code>&nbsp;</div><div class="line number8 index7 alt1"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">no-quorum-policy=</code><code class="bash string">"ignore"</code>&nbsp;</div><div class="line number14 index13 alt1"><code class="bash plain">rsc_defaults $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"rsc-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">resource-stickiness=</code><code class="bash string">"100"</code>&nbsp;</div><div class="line number16 index15 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># commit</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(8).结合上面已经配置好的IP地址资源，将此集群配置成为一个active/passive模型的web（httpd）服务集群</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Node1: &nbsp; <br></span></p><div><div id="highlighter_11291" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># yum -y install httpd&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># echo "&lt;h1&gt;node1.magedu.com&lt;/h1&gt;" &gt; /var/www/html/index.html</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Node2: &nbsp; <br></span></p><div><div id="highlighter_373100" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># yum -y install httpd&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># echo "&lt;h1&gt;node2.magedu.com&lt;/h1&gt;" &gt; /var/www/html/index.html</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">测试一下：</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">node1：</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558794EZAc.png"><img onload="if(this.width&gt;650) this.width=650;" title="node1" style="border-top:0px;border-right:0px;background-image:none;border-bottom:0px;border-left:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="node1" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_13765587958spY.png" height="140" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload=""></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">node2:</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_13765587954Zx1.png"><img onload="if(this.width&gt;650) this.width=650;" title="node2" style="border-top:0px;border-right:0px;background-image:none;border-bottom:0px;border-left:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="node2" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_1376558795fXaz.png" height="133" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload=""></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">而后在各节点手动启动httpd服务，并确认其可以正常提供服务。接着使用下面的命令停止httpd服务，并确保其不会自动启动（在两个节点各执行一遍）：</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">node1: &nbsp; <br></span></p><div><div id="highlighter_863613" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># /etc/init.d/httpd stop&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># chkconfig httpd off</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">node2:</span></p><div><div id="highlighter_841007" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node2~]</code><code class="bash comments"># /etc/init.d/httpd stop</code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># chkconfig httpd off</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">接下来我们将此httpd服务添加为集群资源。将httpd添加为集群资源有两处资源代理可用：lsb和ocf:heartbeat，为了简单起见，我们这里使用lsb类型：<br></span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">首先可以使用如下命令查看lsb类型的httpd资源的语法格式：</span></p><div><div id="highlighter_529215" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># ra </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)ra</code><code class="bash comments"># info lsb:httpd&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">start and stop Apache HTTP Server (lsb:httpd)</code></div><div class="line number4 index3 alt1"><code class="bash plain">The Apache HTTP Server is an efficient and extensible&nbsp; \ </code></div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">server implementing the current HTTP standards.</code></div><div class="line number6 index5 alt1"><code class="bash plain">Operations' defaults (advisory minimum):</code></div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">start&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; timeout=15 </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; timeout=15&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; timeout=15&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">restart&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; timeout=15&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">force-reload&nbsp; timeout=15&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">monitor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; timeout=15 interval=15</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">接下来新建资源httpd： &nbsp; <br></span></p><div><div id="highlighter_803341" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># configure&nbsp;&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># primitive httpd lsb:httpd&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">primitive httpd lsb:httpd&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">primitive vip ocf:heartbeat:IPaddr \&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params ip=</code><code class="bash string">"192.168.18.200"</code> <code class="bash plain">nic=</code><code class="bash string">"eth0"</code> <code class="bash plain">cidr_netmask=</code><code class="bash string">"24"</code>&nbsp;</div><div class="line number9 index8 alt2"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">no-quorum-policy=</code><code class="bash string">"ignore"</code>&nbsp;</div><div class="line number15 index14 alt2"><code class="bash plain">rsc_defaults $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"rsc-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">resource-stickiness=</code><code class="bash string">"100"</code>&nbsp;</div><div class="line number17 index16 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># verify&nbsp;&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># commit</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">来查看一下资源状态</span></p><div><div id="highlighter_175901" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># crm status </code></div><div class="line number2 index1 alt1"><code class="bash plain">Cannot change active directory to </code><code class="bash plain">/var/lib/pacemaker/cores/root</code><code class="bash plain">: No such </code><code class="bash functions">file</code> <code class="bash plain">or directory (2)&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">Last updated: Thu Aug 15 14:55:04 2013&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">Last change: Thu Aug 15 14:54:14 2013 via cibadmin on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash plain">2 Resources configured.</code></div><div class="line number10 index9 alt1"><code class="bash plain">Online: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;</code><code class="bash plain">vip&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;</code><code class="bash plain">httpd&nbsp;&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">从上面的信息中可以看出vip和httpd有可能会分别运行于两个节点上，这对于通过此IP提供Web服务的应用来说是不成立的，即此两者资源必须同时运行在某节点上。有两种方法可以解决，一种是定义组资源，将vip与httpd同时加入一个组中，可以实现将资源运行在同节点上，另一种是定义资源约束可实现将资源运行在同一节点上。我们先来说每一种方法，定义组资源。</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(9).定义组资源 </span></p><div><div id="highlighter_482765" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># configure&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># group webservice vip httpd&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">primitive httpd lsb:httpd&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">primitive vip ocf:heartbeat:IPaddr \&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params ip=</code><code class="bash string">"192.168.18.200"</code> <code class="bash plain">nic=</code><code class="bash string">"eth0"</code> <code class="bash plain">cidr_netmask=</code><code class="bash string">"24"</code>&nbsp;</div><div class="line number9 index8 alt2"><code class="bash plain">group webservice vip httpd&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">no-quorum-policy=</code><code class="bash string">"ignore"</code>&nbsp;</div><div class="line number16 index15 alt1"><code class="bash plain">rsc_defaults $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"rsc-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number17 index16 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">resource-stickiness=</code><code class="bash string">"100"</code>&nbsp;</div><div class="line number18 index17 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># verify&nbsp;&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># commit</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">再次查看一下资源状态</span></p><div><div id="highlighter_167355" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># crm status </code></div><div class="line number2 index1 alt1"><code class="bash plain">Cannot change active directory to </code><code class="bash plain">/var/lib/pacemaker/cores/root</code><code class="bash plain">: No such </code><code class="bash functions">file</code> <code class="bash plain">or directory (2)&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">Last updated: Thu Aug 15 15:33:09 2013&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">Last change: Thu Aug 15 15:32:28 2013 via cibadmin on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash plain">2 Resources configured.</code></div><div class="line number10 index9 alt1"><code class="bash plain">Online: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;</code><code class="bash plain">Resource Group: webservice </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">vip&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">httpd&nbsp;&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">大家可以看到，所有资源全部运行在node2上，下面我们来测试一下</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558795Bzge.png"><img onload="if(this.width&gt;650) this.width=650;" title="crm9" style="border-top:0px;border-right:0px;background-image:none;border-bottom:0px;border-left:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="crm9" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_1376558796nrvX.png" height="149" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload="" width="650"></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">下面我们模拟故障，测试一下</span></p><div><div id="highlighter_329629" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># node&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)node</code><code class="bash comments">#&nbsp;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="bash functions">cd</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="bash plain">end&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; online&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; show&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; status-attr </code></div><div class="line number4 index3 alt1"><code class="bash plain">attribute&nbsp;&nbsp;&nbsp;&nbsp; clearstate&nbsp;&nbsp;&nbsp; </code><code class="bash functions">exit</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="bash plain">list&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; standby&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; up&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">bye&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delete&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fence&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maintenance&nbsp;&nbsp; ready&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; utilization </code></div><div class="line number6 index5 alt1"><code class="bash plain">crm(live)node</code><code class="bash comments"># standby</code></div><div class="line number7 index6 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># crm status </code></div><div class="line number8 index7 alt1"><code class="bash plain">Cannot change active directory to </code><code class="bash plain">/var/lib/pacemaker/cores/root</code><code class="bash plain">: No such </code><code class="bash functions">file</code> <code class="bash plain">or directory (2)&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash plain">Last updated: Thu Aug 15 15:39:05 2013&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash plain">Last change: Thu Aug 15 15:38:57 2013 via crm_attribute on node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash plain">2 Resources configured.</code></div><div class="line number16 index15 alt1"><code class="bash plain">Node node2.</code><code class="bash functions">test</code><code class="bash plain">.com: standby</code></div><div class="line number17 index16 alt2"><code class="bash plain">Online: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number18 index17 alt1"><code class="bash spaces">&nbsp;</code><code class="bash plain">Resource Group: webservice </code></div><div class="line number19 index18 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">vip&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number20 index19 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">httpd&nbsp;&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number21 index20 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># ifconfig&nbsp;&nbsp; </code></div><div class="line number22 index21 alt1"><code class="bash plain">eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Link encap:Ethernet&nbsp; HWaddr 00:0C:29:91:45:90</code></div><div class="line number23 index22 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">inet addr:192.168.18.201&nbsp; Bcast:192.168.18.255&nbsp; Mask:255.255.255.0&nbsp; </code></div><div class="line number24 index23 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">inet6 addr: fe80::20c:29ff:fe91:4590</code><code class="bash plain">/64</code> <code class="bash plain">Scope:Link&nbsp; </code></div><div class="line number25 index24 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1&nbsp; </code></div><div class="line number26 index25 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">RX packets:408780 errors:0 dropped:0 overruns:0 frame:0&nbsp; </code></div><div class="line number27 index26 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">TX packets:323137 errors:0 dropped:0 overruns:0 carrier:0&nbsp; </code></div><div class="line number28 index27 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">collisions:0 txqueuelen:1000&nbsp;&nbsp; </code></div><div class="line number29 index28 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">RX bytes:60432533 (57.6 MiB)&nbsp; TX bytes:57541647 (54.8 MiB)</code></div><div class="line number30 index29 alt1"><code class="bash plain">eth0:0&nbsp;&nbsp;&nbsp; Link encap:Ethernet&nbsp; HWaddr 00:0C:29:91:45:90</code></div><div class="line number31 index30 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">inet addr:192.168.18.200&nbsp; Bcast:192.168.18.255&nbsp; Mask:255.255.255.0&nbsp; </code></div><div class="line number32 index31 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1</code></div><div class="line number33 index32 alt2"><code class="bash plain">lo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Link encap:Local Loopback</code></div><div class="line number34 index33 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">inet addr:127.0.0.1&nbsp; Mask:255.0.0.0&nbsp; </code></div><div class="line number35 index34 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">inet6 addr: ::1</code><code class="bash plain">/128</code> <code class="bash plain">Scope:Host&nbsp; </code></div><div class="line number36 index35 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1&nbsp; </code></div><div class="line number37 index36 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">RX packets:6525 errors:0 dropped:0 overruns:0 frame:0&nbsp; </code></div><div class="line number38 index37 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">TX packets:6525 errors:0 dropped:0 overruns:0 carrier:0&nbsp; </code></div><div class="line number39 index38 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">collisions:0 txqueuelen:0&nbsp;&nbsp; </code></div><div class="line number40 index39 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">RX bytes:882555 (861.8 KiB)&nbsp; TX bytes:882555 (861.8 KiB)</code></div><div class="line number41 index40 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># netstat -ntulp | grep :80 </code></div><div class="line number42 index41 alt1"><code class="bash plain">tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 :::80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :::*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 16603</code><code class="bash plain">/httpd</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">大家可以看到时，当node2节点设置为standby时，所有资源全部切换到node1上，下面我们再来访问一下Web页面</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558796m8Oi.png"><img onload="if(this.width&gt;650) this.width=650;" title="crm10" style="border-top:0px;border-right:0px;background-image:none;border-bottom:0px;border-left:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="crm10" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_13765587960Ufg.png" height="144" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload="" width="650"></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">好了，组资源的定义与说明，我们就先演示到这，下面我们来说一说怎么定义资源约束。</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(10).定义资源约束 </span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">我们先让node2上线，再删除组资源</span></p><div><div id="highlighter_101160" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)node</code><code class="bash comments"># online</code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># crm_mon</code></div><div class="line number3 index2 alt2"><code class="bash plain">Last updated: Thu Aug 15 15:48:38 2013 </code></div><div class="line number4 index3 alt1"><code class="bash plain">Last change: Thu Aug 15 15:46:21 2013 via crm_attribute&nbsp;&nbsp;&nbsp; on node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash plain">2 Resources configured.</code></div><div class="line number10 index9 alt1"><code class="bash plain">Online: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;</code><code class="bash plain">Resource Group: webservice </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">vip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">httpd&nbsp;&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">删除组资源操作</span></p><div><div id="highlighter_834435" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># resource&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)resource</code><code class="bash comments"># show&nbsp;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash spaces">&nbsp;</code><code class="bash plain">Resource Group: webservice&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">vip&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp; Started&nbsp;&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">httpd&nbsp;&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Started&nbsp;&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">crm(live)resource</code><code class="bash comments"># stop webservice&nbsp; #停止资源&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">crm(live)resource</code><code class="bash comments"># show&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;</code><code class="bash plain">Resource Group: webservice&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">vip&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp; Stopped&nbsp;&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">httpd&nbsp;&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Stopped&nbsp;&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash plain">crm(live)resource</code><code class="bash comments"># cleanup webservice&nbsp; #清理资源&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash plain">Cleaning up vip on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash plain">Cleaning up vip on node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash plain">Cleaning up httpd on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash plain">Cleaning up httpd on node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash plain">Waiting </code><code class="bash keyword">for</code> <code class="bash plain">1 replies from the CRMd. OK</code></div><div class="line number17 index16 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># configure&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># delete&nbsp;&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash plain">cib-bootstrap-options&nbsp;&nbsp; node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rsc-options&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; webservice&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number20 index19 alt1"><code class="bash plain">httpd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number21 index20 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># delete webservice #删除组资源&nbsp; </code></div><div class="line number22 index21 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show&nbsp; </code></div><div class="line number23 index22 alt2"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number24 index23 alt1"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com \&nbsp; </code></div><div class="line number25 index24 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">attributes standby=</code><code class="bash string">"off"</code>&nbsp;</div><div class="line number26 index25 alt1"><code class="bash plain">primitive httpd lsb:httpd&nbsp; </code></div><div class="line number27 index26 alt2"><code class="bash plain">primitive vip ocf:heartbeat:IPaddr \&nbsp; </code></div><div class="line number28 index27 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params ip=</code><code class="bash string">"192.168.18.200"</code> <code class="bash plain">nic=</code><code class="bash string">"eth0"</code> <code class="bash plain">cidr_netmask=</code><code class="bash string">"24"</code>&nbsp;</div><div class="line number29 index28 alt2"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number30 index29 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number31 index30 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number32 index31 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number33 index32 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number34 index33 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">no-quorum-policy=</code><code class="bash string">"ignore"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number35 index34 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">last-lrm-refresh=</code><code class="bash string">"1376553277"</code>&nbsp;</div><div class="line number36 index35 alt1"><code class="bash plain">rsc_defaults $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"rsc-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number37 index36 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">resource-stickiness=</code><code class="bash string">"100"</code>&nbsp;</div><div class="line number38 index37 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># commit</code></div><div class="line number39 index38 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># crm_mon</code></div><div class="line number40 index39 alt1"><code class="bash plain">Last updated: Thu Aug 15 15:56:59 2013 </code></div><div class="line number41 index40 alt2"><code class="bash plain">Last change: Thu Aug 15 15:56:12 2013 via cibadmin on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number42 index41 alt1"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number43 index42 alt2"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number44 index43 alt1"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number45 index44 alt2"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number46 index45 alt1"><code class="bash plain">2 Resources configured.</code></div><div class="line number47 index46 alt2"><code class="bash plain">Online: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number48 index47 alt1"><code class="bash plain">vip&nbsp;&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com </code></div><div class="line number49 index48 alt2"><code class="bash plain">httpd&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">大家可以看到资源又重新运行在两个节点上了，下面我们来定义约束！使资源运行在同一节点上。首先我们来回忆一下资源约束的相关知识，资源约束则用以指定在哪些群集节点上运行资源，以何种顺序装载资源，以及特定资源依赖于哪些其它资源。pacemaker共给我们提供了三种资源约束方法：</span></p><ul style="list-style-type:disc;" class=" list-paddingleft-2"><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Resource Location（资源位置）：定义资源可以、不可以或尽可能在哪些节点上运行；</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Resource Collocation（资源排列）：排列约束用以定义集群资源可以或不可以在某个节点上同时运行；</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">Resource Order（资源顺序）：顺序约束定义集群资源在节点上启动的顺序；</span></p></li></ul><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">定义约束时，还需要指定分数。各种分数是集群工作方式的重要组成部分。其实，从迁移资源到决定在已降级集群中停止哪些资源的整个过程是通过以某种方式修改分数来实现的。分数按每个资源来计算，资源分数为负的任何节点都无法运行该资源。在计算出资源分数后，集群选择分数最高的节点。INFINITY（无穷大）目前定义为 1,000,000。加减无穷大遵循以下3个基本规则：</span></p><ul style="list-style-type:disc;" class=" list-paddingleft-2"><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">任何值 + 无穷大 = 无穷大</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">任何值 - 无穷大 = -无穷大</span></p></li><li><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">无穷大 - 无穷大 = -无穷大</span></p></li></ul><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">定义资源约束时，也可以指定每个约束的分数。分数表示指派给此资源约束的值。分数较高的约束先应用，分数较低的约束后应用。通过使用不同的分数为既定资源创建更多位置约束，可以指定资源要故障转移至的目标节点的顺序。因此，对于前述的vip和httpd可能会运行于不同节点的问题，可以通过以下命令来解决：</span></p><div><div id="highlighter_744474" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># colocation httpd-with-ip INFUNTY: httpd vip </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com \&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">attributes standby=</code><code class="bash string">"off"</code>&nbsp;</div><div class="line number6 index5 alt1"><code class="bash plain">primitive httpd lsb:httpd&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">primitive vip ocf:heartbeat:IPaddr \&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params ip=</code><code class="bash string">"192.168.18.200"</code> <code class="bash plain">nic=</code><code class="bash string">"eth0"</code> <code class="bash plain">cidr_netmask=</code><code class="bash string">"24"</code>&nbsp;</div><div class="line number9 index8 alt2"><code class="bash plain">colocation httpd-with-ip INFUNTY: httpd vip&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">no-quorum-policy=</code><code class="bash string">"ignore"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">last-lrm-refresh=</code><code class="bash string">"1376553277"</code>&nbsp;</div><div class="line number17 index16 alt2"><code class="bash plain">rsc_defaults $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"rsc-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">resource-stickiness=</code><code class="bash string">"100"</code>&nbsp;</div><div class="line number19 index18 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show xml</code></div><div class="line number20 index19 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;</code><code class="bash plain">&lt;rsc_colocation </code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"httpd-with-ip"</code> <code class="bash plain">score-attribute=</code><code class="bash string">"INFUNTY"</code> <code class="bash plain">rsc=</code><code class="bash string">"httpd"</code> <code class="bash plain">with-rsc=</code><code class="bash string">"vip"</code><code class="bash plain">/&gt;</code></div><div class="line number21 index20 alt2"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># crm_mon</code></div><div class="line number22 index21 alt1"><code class="bash plain">Last updated: Thu Aug 15 16:12:18 2013 </code></div><div class="line number23 index22 alt2"><code class="bash plain">Last change: Thu Aug 15 16:12:05 2013 via cibadmin on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number24 index23 alt1"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number25 index24 alt2"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number26 index25 alt1"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number27 index26 alt2"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number28 index27 alt1"><code class="bash plain">2 Resources configured.</code></div><div class="line number29 index28 alt2"><code class="bash plain">Online: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number30 index29 alt1"><code class="bash plain">vip&nbsp;&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com </code></div><div class="line number31 index30 alt2"><code class="bash plain">httpd&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">大家可以看到，所有资源全部运行在node1上，下面我们来测试访问一下</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_13765587994Utu.png"><img onload="if(this.width&gt;650) this.width=650;" title="crm10" style="border-top:0px;border-right:0px;background-image:none;border-bottom:0px;border-left:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="crm10" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_1376558800Tyqp.png" height="144" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload="" width="650"></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">模拟一下故障，再进行测试</span></p><div><div id="highlighter_862460" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># node </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)node</code><code class="bash comments"># standby&nbsp;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">crm(live)node</code><code class="bash comments"># show&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">node1.</code><code class="bash functions">test</code><code class="bash plain">.com: normal&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">standby: on&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">node2.</code><code class="bash functions">test</code><code class="bash plain">.com: normal&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">standby: off</code></div><div class="line number8 index7 alt1"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># crm_mon</code></div><div class="line number9 index8 alt2"><code class="bash plain">Last updated: Thu Aug 15 16:14:33 2013 </code></div><div class="line number10 index9 alt1"><code class="bash plain">Last change: Thu Aug 15 16:14:23 2013 via crm_attribute&nbsp;&nbsp;&nbsp; on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash plain">2 Resources configured.</code></div><div class="line number16 index15 alt1"><code class="bash plain">Node node1.</code><code class="bash functions">test</code><code class="bash plain">.com: standby&nbsp; </code></div><div class="line number17 index16 alt2"><code class="bash plain">Online: [ node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number18 index17 alt1"><code class="bash plain">vip&nbsp;&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com </code></div><div class="line number19 index18 alt2"><code class="bash plain">httpd&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">大家可以看到，资源全部移动到node2上了，再进行测试</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558800QoCi.png"><img onload="if(this.width&gt;650) this.width=650;" title="crm9" style="border-top:0px;border-right:0px;background-image:none;border-bottom:0px;border-left:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="crm9" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_1376558800xqPW.png" height="149" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload="" width="650"></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">接着，我们还得确保httpd在某节点启动之前得先启动vip，这可以使用如下命令实现：</span></p><div><div id="highlighter_309489" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># configure&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># order httpd-after-vip mandatory: vip httpd&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># verify&nbsp;&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show&nbsp;&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com \&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">attributes standby=</code><code class="bash string">"on"</code>&nbsp;</div><div class="line number7 index6 alt2"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com \&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">attributes standby=</code><code class="bash string">"off"</code>&nbsp;</div><div class="line number9 index8 alt2"><code class="bash plain">primitive httpd lsb:httpd \&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">meta target-role=</code><code class="bash string">"Started"</code>&nbsp;</div><div class="line number11 index10 alt2"><code class="bash plain">primitive vip ocf:heartbeat:IPaddr \&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params ip=</code><code class="bash string">"192.168.18.200"</code> <code class="bash plain">nic=</code><code class="bash string">"eth0"</code> <code class="bash plain">cidr_netmask=</code><code class="bash string">"24"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">meta target-role=</code><code class="bash string">"Started"</code>&nbsp;</div><div class="line number14 index13 alt1"><code class="bash plain">colocation httpd-with-ip INFUNTY: httpd vip&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash plain">order httpd-after-vip inf: vip httpd&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number17 index16 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number20 index19 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number21 index20 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">no-quorum-policy=</code><code class="bash string">"ignore"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number22 index21 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">last-lrm-refresh=</code><code class="bash string">"1376554276"</code>&nbsp;</div><div class="line number23 index22 alt2"><code class="bash plain">rsc_defaults $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"rsc-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number24 index23 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">resource-stickiness=</code><code class="bash string">"100"</code>&nbsp;</div><div class="line number25 index24 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show xml</code></div><div class="line number26 index25 alt1"><code class="bash spaces">&nbsp;</code><code class="bash plain">&lt;rsc_order </code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"httpd-after-vip"</code> <code class="bash plain">score=</code><code class="bash string">"INFINITY"</code> <code class="bash plain">first=</code><code class="bash string">"vip"</code> <code class="bash keyword">then</code><code class="bash plain">=</code><code class="bash string">"httpd"</code><code class="bash plain">/&gt;</code></div><div class="line number27 index26 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># commit</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">此外，由于HA集群本身并不强制每个节点的性能相同或相近。所以，某些时候我们可能希望在正常时服务总能在某个性能较强的节点上运行，这可以通过位置约束来实现：</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">crm(live)configure# location prefer-node1 vip node_pref::200: node1</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">好了，到这里高可用的Web集群的基本配置全部完成，下面我们来讲一下增加nfs资源。</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">8.crmsh 配置nfs资源</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(1).配置NFS服务器</span></p><div><div id="highlighter_139321" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@nfs ~]</code><code class="bash comments"># mkdir -pv /web</code></div><div class="line number2 index1 alt1"><code class="bash functions">mkdir</code><code class="bash plain">: 已创建目录 “</code><code class="bash plain">/web</code><code class="bash plain">”</code></div><div class="line number3 index2 alt2"><code class="bash plain">[root@nfs ~]</code><code class="bash comments"># vim /etc/exports</code></div><div class="line number4 index3 alt1"><code class="bash plain">/web/192</code><code class="bash plain">.168.18.0</code><code class="bash plain">/24</code><code class="bash plain">(ro,async)</code></div><div class="line number5 index4 alt2"><code class="bash plain">[root@nfs /]</code><code class="bash comments"># echo '&lt;h1&gt;Cluster NFS Server&lt;/h1&gt;' &gt; /web/index.html</code></div><div class="line number6 index5 alt1"><code class="bash plain">[root@nfs ~]</code><code class="bash comments"># /etc/init.d/rpcbind start</code></div><div class="line number7 index6 alt2"><code class="bash plain">启动 rpcbind ：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [确定]</code></div><div class="line number8 index7 alt1"><code class="bash plain">[root@nfs /]</code><code class="bash comments"># /etc/init.d/nfs start&nbsp;&nbsp;&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash plain">启动 NFS 服务：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [确定]</code></div><div class="line number10 index9 alt1"><code class="bash plain">关掉 NFS 配额：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [确定]</code></div><div class="line number11 index10 alt2"><code class="bash plain">启动 NFS 守护进程：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [确定]</code></div><div class="line number12 index11 alt1"><code class="bash plain">启动 NFS mountd：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [确定]</code></div><div class="line number13 index12 alt2"><code class="bash plain">[root@nfs /]</code><code class="bash comments"># showmount -e 192.168.18.208</code></div><div class="line number14 index13 alt1"><code class="bash plain">Export list for192.168.18.208:</code></div><div class="line number15 index14 alt2"><code class="bash plain">/web192</code><code class="bash plain">.168.18.0</code><code class="bash plain">/24</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(2).节点测试挂载</span></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">node1:</span></p><div><div id="highlighter_893934" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># mount -t nfs 192.168.18.208:/web /mnt</code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># cd /mnt/</code></div><div class="line number3 index2 alt2"><code class="bash plain">[root@node1 mnt]</code><code class="bash comments"># ll</code></div><div class="line number4 index3 alt1"><code class="bash plain">总计 4</code></div><div class="line number5 index4 alt2"><code class="bash plain">-rw-r--r-- 1 root root 28 08-07 17:41 index.html</code></div><div class="line number6 index5 alt1"><code class="bash plain">[root@node1 mnt]</code><code class="bash comments"># mount</code></div><div class="line number7 index6 alt2"><code class="bash plain">/dev/sda2on</code> <code class="bash plain">/ typeext3 (rw)</code></div><div class="line number8 index7 alt1"><code class="bash plain">proc on </code><code class="bash plain">/proctypeproc</code> <code class="bash plain">(rw)</code></div><div class="line number9 index8 alt2"><code class="bash plain">sysfs on </code><code class="bash plain">/systypesysfs</code> <code class="bash plain">(rw)</code></div><div class="line number10 index9 alt1"><code class="bash plain">devpts on </code><code class="bash plain">/dev/ptstypedevpts</code> <code class="bash plain">(rw,gid=5,mode=620)</code></div><div class="line number11 index10 alt2"><code class="bash plain">/dev/sda3on</code> <code class="bash plain">/datatypeext3</code> <code class="bash plain">(rw)</code></div><div class="line number12 index11 alt1"><code class="bash plain">/dev/sda1on</code> <code class="bash plain">/boottypeext3</code> <code class="bash plain">(rw)</code></div><div class="line number13 index12 alt2"><code class="bash plain">tmpfs on </code><code class="bash plain">/dev/shmtypetmpfs</code> <code class="bash plain">(rw)</code></div><div class="line number14 index13 alt1"><code class="bash plain">none on </code><code class="bash plain">/proc/sys/fs/binfmt_misctypebinfmt_misc</code> <code class="bash plain">(rw)</code></div><div class="line number15 index14 alt2"><code class="bash plain">sunrpc on </code><code class="bash plain">/var/lib/nfs/rpc_pipefstyperpc_pipefs</code> <code class="bash plain">(rw)</code></div><div class="line number16 index15 alt1"><code class="bash plain">192.168.18.208:</code><code class="bash plain">/webon</code> <code class="bash plain">/mnttypenfs</code> <code class="bash plain">(rw,addr=192.168.18.208)</code></div><div class="line number17 index16 alt2"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># umount /mnt</code></div><div class="line number18 index17 alt1"><code class="bash plain">[root@node1 ~]</code><code class="bash comments"># mount</code></div><div class="line number19 index18 alt2"><code class="bash plain">/dev/sda2on</code> <code class="bash plain">/ typeext3 (rw)</code></div><div class="line number20 index19 alt1"><code class="bash plain">proc on </code><code class="bash plain">/proctypeproc</code> <code class="bash plain">(rw)</code></div><div class="line number21 index20 alt2"><code class="bash plain">sysfs on </code><code class="bash plain">/systypesysfs</code> <code class="bash plain">(rw)</code></div><div class="line number22 index21 alt1"><code class="bash plain">devpts on </code><code class="bash plain">/dev/ptstypedevpts</code> <code class="bash plain">(rw,gid=5,mode=620)</code></div><div class="line number23 index22 alt2"><code class="bash plain">/dev/sda3on</code> <code class="bash plain">/datatypeext3</code> <code class="bash plain">(rw)</code></div><div class="line number24 index23 alt1"><code class="bash plain">/dev/sda1on</code> <code class="bash plain">/boottypeext3</code> <code class="bash plain">(rw)</code></div><div class="line number25 index24 alt2"><code class="bash plain">tmpfs on </code><code class="bash plain">/dev/shmtypetmpfs</code> <code class="bash plain">(rw)</code></div><div class="line number26 index25 alt1"><code class="bash plain">none on </code><code class="bash plain">/proc/sys/fs/binfmt_misctypebinfmt_misc</code> <code class="bash plain">(rw)</code></div><div class="line number27 index26 alt2"><code class="bash plain">sunrpc on </code><code class="bash plain">/var/lib/nfs/rpc_pipefstyperpc_pipefs</code> <code class="bash plain">(rw)</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">node2:</span></p><div><div id="highlighter_432125" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># mount -t nfs 192.168.18.208:/web /mnt</code></div><div class="line number2 index1 alt1"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># cd /mnt</code></div><div class="line number3 index2 alt2"><code class="bash plain">[root@node2 mnt]</code><code class="bash comments"># ll</code></div><div class="line number4 index3 alt1"><code class="bash plain">总计 4</code></div><div class="line number5 index4 alt2"><code class="bash plain">-rw-r--r-- 1 root root 28 08-07 17:41 index.html</code></div><div class="line number6 index5 alt1"><code class="bash plain">[root@node2 mnt]</code><code class="bash comments"># mount</code></div><div class="line number7 index6 alt2"><code class="bash plain">/dev/sda2on</code> <code class="bash plain">/ typeext3 (rw)</code></div><div class="line number8 index7 alt1"><code class="bash plain">proc on </code><code class="bash plain">/proctypeproc</code> <code class="bash plain">(rw)</code></div><div class="line number9 index8 alt2"><code class="bash plain">sysfs on </code><code class="bash plain">/systypesysfs</code> <code class="bash plain">(rw)</code></div><div class="line number10 index9 alt1"><code class="bash plain">devpts on </code><code class="bash plain">/dev/ptstypedevpts</code> <code class="bash plain">(rw,gid=5,mode=620)</code></div><div class="line number11 index10 alt2"><code class="bash plain">/dev/sda3on</code> <code class="bash plain">/datatypeext3</code> <code class="bash plain">(rw)</code></div><div class="line number12 index11 alt1"><code class="bash plain">/dev/sda1on</code> <code class="bash plain">/boottypeext3</code> <code class="bash plain">(rw)</code></div><div class="line number13 index12 alt2"><code class="bash plain">tmpfs on </code><code class="bash plain">/dev/shmtypetmpfs</code> <code class="bash plain">(rw)</code></div><div class="line number14 index13 alt1"><code class="bash plain">none on </code><code class="bash plain">/proc/sys/fs/binfmt_misctypebinfmt_misc</code> <code class="bash plain">(rw)</code></div><div class="line number15 index14 alt2"><code class="bash plain">sunrpc on </code><code class="bash plain">/var/lib/nfs/rpc_pipefstyperpc_pipefs</code> <code class="bash plain">(rw)</code></div><div class="line number16 index15 alt1"><code class="bash plain">192.168.18.208:</code><code class="bash plain">/webon</code> <code class="bash plain">/mnttypenfs</code> <code class="bash plain">(rw,addr=192.168.18.208)</code></div><div class="line number17 index16 alt2"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># umount /mnt</code></div><div class="line number18 index17 alt1"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># mount</code></div><div class="line number19 index18 alt2"><code class="bash plain">/dev/sda2on</code> <code class="bash plain">/ typeext3 (rw)</code></div><div class="line number20 index19 alt1"><code class="bash plain">proc on </code><code class="bash plain">/proctypeproc</code> <code class="bash plain">(rw)</code></div><div class="line number21 index20 alt2"><code class="bash plain">sysfs on </code><code class="bash plain">/systypesysfs</code> <code class="bash plain">(rw)</code></div><div class="line number22 index21 alt1"><code class="bash plain">devpts on </code><code class="bash plain">/dev/ptstypedevpts</code> <code class="bash plain">(rw,gid=5,mode=620)</code></div><div class="line number23 index22 alt2"><code class="bash plain">/dev/sda3on</code> <code class="bash plain">/datatypeext3</code> <code class="bash plain">(rw)</code></div><div class="line number24 index23 alt1"><code class="bash plain">/dev/sda1on</code> <code class="bash plain">/boottypeext3</code> <code class="bash plain">(rw)</code></div><div class="line number25 index24 alt2"><code class="bash plain">tmpfs on </code><code class="bash plain">/dev/shmtypetmpfs</code> <code class="bash plain">(rw)</code></div><div class="line number26 index25 alt1"><code class="bash plain">none on </code><code class="bash plain">/proc/sys/fs/binfmt_misctypebinfmt_misc</code> <code class="bash plain">(rw)</code></div><div class="line number27 index26 alt2"><code class="bash plain">sunrpc on </code><code class="bash plain">/var/lib/nfs/rpc_pipefstyperpc_pipefs</code> <code class="bash plain">(rw)</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(3).配置资源 vip 、httpd、nfs</span></p><div><div id="highlighter_255000" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># configure&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">no-quorum-policy=</code><code class="bash string">"ignore"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">last-lrm-refresh=</code><code class="bash string">"1376555949"</code>&nbsp;</div><div class="line number12 index11 alt1"><code class="bash plain">rsc_defaults $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"rsc-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">resource-stickiness=</code><code class="bash string">"100"</code>&nbsp;</div><div class="line number14 index13 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># primitive vip ocf:heartbeat:IPaddr params ip=192.168.18.200 nic=eth0 cidr_netmask=24&nbsp;&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># primitive httpd lsb:httpd&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># primitive nfs ocf:heartbeat:Filesystem params device=192.168.18.208:/web directory=/var/www/html fstype=nfs&nbsp; </code></div><div class="line number17 index16 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># verify&nbsp;&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash plain">WARNING: nfs: default timeout 20s </code><code class="bash keyword">for</code> <code class="bash plain">start is smaller than the advised 60&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash plain">WARNING: nfs: default timeout 20s </code><code class="bash keyword">for</code> <code class="bash plain">stop is smaller than the advised 60&nbsp; </code></div><div class="line number20 index19 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show&nbsp; </code></div><div class="line number21 index20 alt2"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number22 index21 alt1"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number23 index22 alt2"><code class="bash plain">primitive httpd lsb:httpd&nbsp; </code></div><div class="line number24 index23 alt1"><code class="bash plain">primitive nfs ocf:heartbeat:Filesystem \&nbsp; </code></div><div class="line number25 index24 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params device=</code><code class="bash string">"192.168.18.208:/web"</code> <code class="bash plain">directory=</code><code class="bash string">"/var/www/html"</code> <code class="bash plain">fstype=</code><code class="bash string">"nfs"</code>&nbsp;</div><div class="line number26 index25 alt1"><code class="bash plain">primitive vip ocf:heartbeat:IPaddr \&nbsp; </code></div><div class="line number27 index26 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params ip=</code><code class="bash string">"192.168.18.200"</code> <code class="bash plain">nic=</code><code class="bash string">"eth0"</code> <code class="bash plain">cidr_netmask=</code><code class="bash string">"24"</code>&nbsp;</div><div class="line number28 index27 alt1"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number29 index28 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number30 index29 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number31 index30 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number32 index31 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number33 index32 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">no-quorum-policy=</code><code class="bash string">"ignore"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number34 index33 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">last-lrm-refresh=</code><code class="bash string">"1376555949"</code>&nbsp;</div><div class="line number35 index34 alt2"><code class="bash plain">rsc_defaults $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"rsc-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number36 index35 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">resource-stickiness=</code><code class="bash string">"100"</code>&nbsp;</div><div class="line number37 index36 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># commit&nbsp;&nbsp; </code></div><div class="line number38 index37 alt1"><code class="bash plain">WARNING: nfs: default timeout 20s </code><code class="bash keyword">for</code> <code class="bash plain">start is smaller than the advised 60&nbsp; </code></div><div class="line number39 index38 alt2"><code class="bash plain">WARNING: nfs: default timeout 20s </code><code class="bash keyword">for</code> <code class="bash plain">stop is smaller than the advised 60</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">查看一下定义的三个资源，大家可以看到三个资源不在同一个节点上，下面我们定义一下组资源，来使三个资源在同一节点上。</span></p><div><div id="highlighter_581811" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># crm_mon</code></div><div class="line number2 index1 alt1"><code class="bash plain">Last updated: Thu Aug 15 17:00:17 2013 </code></div><div class="line number3 index2 alt2"><code class="bash plain">Last change: Thu Aug 15 16:58:44 2013 via cibadmin on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">3 Resources configured.</code></div><div class="line number9 index8 alt2"><code class="bash plain">Online: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number10 index9 alt1"><code class="bash plain">vip&nbsp;&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com </code></div><div class="line number11 index10 alt2"><code class="bash plain">httpd&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash plain">nfs&nbsp;&nbsp;&nbsp;&nbsp; (ocf::heartbeat:Filesystem):&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(4).定义组资源</span></p><div><div id="highlighter_966849" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># configure&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># group webservice vip nfs httpd&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">crm(live)configure</code><code class="bash comments"># verify&nbsp;&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># show&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">node node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">node node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">primitive httpd lsb:httpd&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">primitive nfs ocf:heartbeat:Filesystem \&nbsp; </code></div><div class="line number9 index8 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params device=</code><code class="bash string">"192.168.18.208:/web"</code> <code class="bash plain">directory=</code><code class="bash string">"/var/www/html"</code> <code class="bash plain">fstype=</code><code class="bash string">"nfs"</code>&nbsp;</div><div class="line number10 index9 alt1"><code class="bash plain">primitive vip ocf:heartbeat:IPaddr \&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">params ip=</code><code class="bash string">"192.168.18.200"</code> <code class="bash plain">nic=</code><code class="bash string">"eth0"</code> <code class="bash plain">cidr_netmask=</code><code class="bash string">"24"</code>&nbsp;</div><div class="line number12 index11 alt1"><code class="bash plain">group webservice vip nfs httpd&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash plain">property $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"cib-bootstrap-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash functions">dc</code><code class="bash plain">-version=</code><code class="bash string">"1.1.8-7.el6-394e906"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number15 index14 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">cluster-infrastructure=</code><code class="bash string">"classic openais (with plugin)"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">expected-quorum-votes=</code><code class="bash string">"2"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number17 index16 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">stonith-enabled=</code><code class="bash string">"false"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number18 index17 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">no-quorum-policy=</code><code class="bash string">"ignore"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">last-lrm-refresh=</code><code class="bash string">"1376555949"</code>&nbsp;</div><div class="line number20 index19 alt1"><code class="bash plain">rsc_defaults $</code><code class="bash functions">id</code><code class="bash plain">=</code><code class="bash string">"rsc-options"</code> <code class="bash plain">\&nbsp; </code></div><div class="line number21 index20 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">resource-stickiness=</code><code class="bash string">"100"</code>&nbsp;</div><div class="line number22 index21 alt1"><code class="bash plain">crm(live)configure</code><code class="bash comments"># commit</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">查看一下资源状态，所有资源全部在node1上，下面我们测试一下</span></p><div><div id="highlighter_333062" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># crm_mon</code></div><div class="line number2 index1 alt1"><code class="bash plain">Last updated: Thu Aug 15 17:03:20 2013 </code></div><div class="line number3 index2 alt2"><code class="bash plain">Last change: Thu Aug 15 17:02:44 2013 via cibadmin on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number7 index6 alt2"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number8 index7 alt1"><code class="bash plain">3 Resources configured.</code></div><div class="line number9 index8 alt2"><code class="bash plain">Online: [ node1.</code><code class="bash functions">test</code><code class="bash plain">.com node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number10 index9 alt1"><code class="bash spaces">&nbsp;</code><code class="bash plain">Resource Group: webservice </code></div><div class="line number11 index10 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">vip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">nfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (ocf::heartbeat:Filesystem):&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">httpd&nbsp;&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Started node1.</code><code class="bash functions">test</code><code class="bash plain">.com</code></div></div></td></tr></tbody></table></div></div><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_13765588019dVe.png"><img onload="if(this.width&gt;650) this.width=650;" title="crm11" style="border-top:0px;border-right:0px;background-image:none;border-bottom:0px;border-left:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="crm11" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_137655880198Zx.png" height="160" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload="" width="650"></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">(5).最后我们模拟一下资源故障</span></p><div><div id="highlighter_222199" class="syntaxhighlighter  bash"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">crm(live)</code><code class="bash comments"># node&nbsp; </code></div><div class="line number2 index1 alt1"><code class="bash plain">crm(live)node</code><code class="bash comments"># standby&nbsp;&nbsp; </code></div><div class="line number3 index2 alt2"><code class="bash plain">crm(live)node</code><code class="bash comments"># show&nbsp; </code></div><div class="line number4 index3 alt1"><code class="bash plain">node1.</code><code class="bash functions">test</code><code class="bash plain">.com: normal&nbsp; </code></div><div class="line number5 index4 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">standby: on&nbsp; </code></div><div class="line number6 index5 alt1"><code class="bash plain">node2.</code><code class="bash functions">test</code><code class="bash plain">.com: normal</code></div><div class="line number7 index6 alt2"><code class="bash plain">[root@node2 ~]</code><code class="bash comments"># crm_mon</code></div><div class="line number8 index7 alt1"><code class="bash plain">Last updated: Thu Aug 15 17:05:52 2013 </code></div><div class="line number9 index8 alt2"><code class="bash plain">Last change: Thu Aug 15 17:05:42 2013 via crm_attribute&nbsp;&nbsp;&nbsp; on node1.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number10 index9 alt1"><code class="bash plain">Stack: classic openais (with plugin)&nbsp; </code></div><div class="line number11 index10 alt2"><code class="bash plain">Current DC: node2.</code><code class="bash functions">test</code><code class="bash plain">.com - partition with quorum&nbsp; </code></div><div class="line number12 index11 alt1"><code class="bash plain">Version: 1.1.8-7.el6-394e906&nbsp; </code></div><div class="line number13 index12 alt2"><code class="bash plain">2 Nodes configured, 2 expected votes&nbsp; </code></div><div class="line number14 index13 alt1"><code class="bash plain">3 Resources configured.</code></div><div class="line number15 index14 alt2"><code class="bash plain">Node node1.</code><code class="bash functions">test</code><code class="bash plain">.com: standby&nbsp; </code></div><div class="line number16 index15 alt1"><code class="bash plain">Online: [ node2.</code><code class="bash functions">test</code><code class="bash plain">.com ]</code></div><div class="line number17 index16 alt2"><code class="bash spaces">&nbsp;</code><code class="bash plain">Resource Group: webservice </code></div><div class="line number18 index17 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">vip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (ocf::heartbeat:IPaddr):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number19 index18 alt2"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">nfs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (ocf::heartbeat:Filesystem):&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com&nbsp; </code></div><div class="line number20 index19 alt1"><code class="bash spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="bash plain">httpd&nbsp;&nbsp;&nbsp; (lsb:httpd):&nbsp;&nbsp;&nbsp; Started node2.</code><code class="bash functions">test</code><code class="bash plain">.com</code></div></div></td></tr></tbody></table></div></div><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">当node1故障时，所有资源全部移动到时node2上，下面我们再来访问一下吧</span></p><p><a target="\&quot;_blank\&quot;" href="http://img1.51cto.com/attachment/201308/15/2033581_1376558801WtE6.png"><img onload="if(this.width&gt;650) this.width=650;" title="crm11" style="border-top:0px;border-right:0px;background-image:none;border-bottom:0px;border-left:0px;padding-top:0px;padding-left:0px;padding-right:0px;" border="0" alt="crm11" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/2033581_13765588018KSH.png" height="160" onabort="" onblur="" onchange="" onclick="" ondblclick="" onerror="" onfocus="" onkeydown="" onkeypress="" onkeyup="" onmousedown="" onmousemove="" onmouseout="" onmouseover="" onmouseup="" onreset="" onresize="" onselect="" onsubmit="" onunload="" width="650"></a></p><p><span style="font-family:arial, helvetica, sans-serif;font-size:14px;">大家可以看到，照样能访问，好了今天的博客就到这边，在下一篇博客中我们将重点讲解DRDB知识。^_^……</span></p><p><br></p><p>本文出自 “<a href="http://freeloda.blog.51cto.com/">Share your knowledge …</a>” 博客，请务必保留此出处<a href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客.html">http://freeloda.blog.51cto.com/2033581/1274533</a></p>
    		</div><!--正文 end-->
<script type="text/javascript">
	var kevent = 'onabort|onblur|onchange|onclick|ondblclick|onerror|onfocus|onkeydown|onkeypress|onkeyup|onload|onmousedown|onmousemove|onmouseout|onmouseover|onmouseup|onreset|onresize|onselect|onsubmit|onunload';
	var aevent = kevent.split('|');

	jQuery('.showContent img').each(function(){
		var nimg = this;
		jQuery.each(aevent, function(i, n){
			if (n!='onload') {
				jQuery(nimg).attr(n, '');
			} else {
				if (jQuery(nimg).attr(n) != 'if(this.width>650) this.width=650;') {
					jQuery(nimg).attr(n, '');
				}
			}
		});
	});
</script>
<script type="text/javascript" charset="utf-8">
var encodetitle = encodeURI('一篇很棒的博文分享给大家：《Linux 高可用（HA）集群之Pacemaker详解》');

function show51share(){

	window.open('http://t.51cto.com/index.php?m=share&url=http://freeloda.blog.51cto.com/2033581/1274533&type=l&count=&relateUid=&appkey=3843950324&title=' + encodetitle);
}
</script>		
<div class="m_sharebtn clear">
	<table width="100%" border="0" cellspacing="0" cellpadding="0">
	  <tbody><tr>
		<td width="11%" height="43" align="center" valign="middle"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/ssk.png" alt="分享至"></td>
		<td width="77%" align="left" valign="top">
<!-- 			
<div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_mshare" data-cmd="mshare" title="分享到一键分享"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_bdhome" data-cmd="bdhome" title="分享到百度新首页"></a><a href="#" class="bds_tieba" data-cmd="tieba" title="分享到百度贴吧"></a><a href="#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a><a href="#" class="bds_bdysc" data-cmd="bdysc" title="分享到百度云收藏"></a><a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a></div>
<script>
var bds_config = {'wbUid':1706976420};
window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false, 'bdPic':'http://blog.51cto.com/attachment/201305/173413310.jpg',"bdStyle":"1","bdSize":"32"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>
 -->

<div class="bdsharebuttonbox bdshare-button-style1-32" data-bd-bind="1433298162340"><a href="http://freeloda.blog.51cto.com/#" class="bds_more" data-cmd="more"></a><a href="http://freeloda.blog.51cto.com/#" class="bds_mshare" data-cmd="mshare" title="分享到一键分享"></a><a href="http://freeloda.blog.51cto.com/#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="http://freeloda.blog.51cto.com/#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a><a href="http://freeloda.blog.51cto.com/#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="http://freeloda.blog.51cto.com/#" class="bds_bdhome" data-cmd="bdhome" title="分享到百度新首页"></a><a href="http://freeloda.blog.51cto.com/#" class="bds_tieba" data-cmd="tieba" title="分享到百度贴吧"></a><a href="http://freeloda.blog.51cto.com/#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a><a href="http://freeloda.blog.51cto.com/#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a><a href="http://freeloda.blog.51cto.com/#" class="bds_bdysc" data-cmd="bdysc" title="分享到百度云收藏"></a><a href="http://freeloda.blog.51cto.com/#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{"tsina":"2065779340"},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"http://blog.51cto.com/img/blog_down0731.jpg","bdStyle":"1","bdSize":"32"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>

	<!-- Baidu Button END --></td>
		<td width="12%" align="right" valign="middle"><a href="javascript:favorBox('open');" title="一键收藏，随时查看，分享好友！"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/favorite_add_small.gif" border="0" alt="一键收藏，随时查看，分享好友！"></a></td>
	  </tr>
	</tbody></table>

</div>			
    		<div class="showBottom">
            <!--<div class="reviews"><span class="fl" style="cursor:pointer;"><a onclick="openFavoulist();" id="favourer">457359752、yhftp、yeyeyeyuyu</a>

            </span><div id="favourdiv" class="support01">15人</div>
              <span class="fl">了这篇文章</span></div>-->
              <table width="720" border="0" cellspacing="0" cellpadding="0">
  <tbody><tr>
    <td align="right"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/icon01.png" width="15" height="16"> <span style="cursor:pointer;"><a onclick="openFavoulist();" id="favourer">457359752、yhftp、yeyeyeyuyu</a></span></td>
    <td width="70" align="left"><div style="line-height:28px;" id="favourdiv" class="support01">15人</div></td>
    <td width="60" align="left">了这篇文章</td>
  </tr>
</tbody></table>




            <div class="showType">类别：<a href="http://freeloda.blog.51cto.com/2033581/d-4" class="operlink">Linux集群与存储专题</a>┆阅读(<span id="readNum">10697</span>)┆评论(<span id="cmtNum">18</span>)

┆
<a href="http://freeloda.blog.51cto.com/">返回博主首页</a>┆<a href="http://blog.51cto.com/">返回博客首页</a></div>
            <div class="prevNext">

			上一篇 <a href="http://freeloda.blog.51cto.com/2033581/1272417" class="operlink" title="Linux 高可用（HA）集群之Corosync详解">Linux 高可用（HA）集群之Corosync详解</a>


			下一篇 <a href="http://freeloda.blog.51cto.com/2033581/1275384" class="operlink" title="Linux 高可用（HA）集群之DRBD详解">Linux 高可用（HA）集群之DRBD详解</a>


            </div>

            </div>

	  </div><!--showBottom end-->
      </div><!--modCon-->
    <span class="modBot"></span>
    </div><!--artShow end-->
    <span class="blank"></span>
	
	<div class="relatedArt box">
<a href="http://wot.51cto.com/2015mobile/" target="_blank"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/wKioL1VJvgyBaNdHAADPRRZNXvg232.jpg"></a>
</div>
	


    <div class="relatedArt box">
    <div class="title" name="zhuanti" id="zhuanti"><h2>相关文章</h2></div>
    <div class="modCon">
<ul>

<li><a href="http://acreep.blog.51cto.com/3333560/642987" title="Perl 开发的学习-1" target="_blank">Perl 开发的学习-1</a></li>


<li><a href="http://songxj.blog.51cto.com/620981/1265689" title="inotify+rsync+ssh 同步" target="_blank">inotify+rsync+ssh 同步</a></li>


<li><a href="http://1704730.blog.51cto.com/1694730/1052499" title="linux 重定向命令(转自http://www.cnblogs.com/lovemo1314/archive/2011/07/13/210" target="_blank">linux 重定向命令(转自http://www.cnblogs.c..</a></li>


<li><a href="http://windowsemo.blog.51cto.com/7458261/1266811" title="手工创建精简linux" target="_blank">手工创建精简linux</a></li>


<li><a href="http://mickole.blog.51cto.com/7547481/1246752" title="linux系统编程之文件与I0：文件描述符相关操作-dup,dup2,fcntl" target="_blank">linux系统编程之文件与I0：文件描述符相关操..</a></li>


<li><a href="http://mickole.blog.51cto.com/7547481/1247677" title="linux系统编程之进程（四）：进程退出exit，_exit区别即atexit函数" target="_blank">linux系统编程之进程（四）：进程退出exit，..</a></li>


<li><a href="http://mickole.blog.51cto.com/7547481/1246749" title="linux系统编程之文件与IO：时间函数小结" target="_blank">linux系统编程之文件与IO：时间函数小结</a></li>


<li><a href="http://luyx30.blog.51cto.com/1029851/1084508" title="Linux中rename命令的用法" target="_blank">Linux中rename命令的用法</a></li>


<li><a href="http://perlin.blog.51cto.com/1202304/985310" title="分享几个Linux下监控流量的软件" target="_blank">分享几个Linux下监控流量的软件</a></li>


<li><a href="http://zhangfuture.blog.51cto.com/3375371/1250693" title="VMware OSP对比VMware Tools：简化Linux驱动更新" target="_blank">VMware OSP对比VMware Tools：简化Linux驱动..</a></li>



</ul>



<span class="blank6"></span>
</div><!--modCon end-->
<span class="modBot"></span>
</div><!--相关文章 end-->


<div class="artComm box">
    <div class="title"><a name="replay"></a><h2>文章评论</h2></div>
    <div class="modCon" id="artcomment">
		<div> <a href="" onclick="getcomment(1274533,1);return false">&nbsp;&lt;&lt;&nbsp;</a>&nbsp;&nbsp;<b>1</b>&nbsp; <a href="" onclick="getcomment(1274533,2);return false">&nbsp;2&nbsp;</a> <input type="text" size="2" id="com_top" name="com_top" style="height: 16px; border:1px solid #E5E5E5;" onkeydown="javascript: if(event.keyCode==13) getcomment(1274533,this.value);"> <a href="" onclick="getcomment(1274533,2);return false">&nbsp;&gt;&gt;&nbsp;</a>&nbsp;&nbsp;页数 ( 1/2 ) &nbsp;</div><a name="576501"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid0"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[1楼]&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://qiufengy.blog.51cto.com/" class="operlink" ref="nofollow"><b>qiufengy</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="qiufengy" parentid="576501">回复</a></label></div></div><div align="right">2013-08-16 09:40:55</div><div class="commentcontent">看上去貌似比较麻烦啊。这是不是此软件不太流行的原因呢？高可用用keepalived＋script做也还可以的。</div></div><br><a name="576568"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid1"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[2楼]&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://xiaoli110.blog.51cto.com/" class="operlink" ref="nofollow"><b>xiaoli110</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="xiaoli110" parentid="576568">回复</a></label></div></div><div align="right">2013-08-16 16:41:42</div><div class="commentcontent">太强了，非常系统，顶一个。</div></div><br><a name="576581"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid2"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[3楼]&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://litaotao.blog.51cto.com/" class="operlink" ref="nofollow"><b>jie783213507</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="jie783213507" parentid="576581">回复</a></label></div></div><div align="right">2013-08-16 18:38:37</div><div class="commentcontent">博主太强大了，Pacemaker 是众多集群实现中，唯一没有研究过的，以后有时间研究的时候，好好看看博主的博客</div></div><br><a name="576606"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid3"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[4楼]<a href="http://freeloda.blog.51cto.com/">楼主</a>&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://freeloda.blog.51cto.com/" class="operlink" ref="nofollow"><b>陈明乾</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="陈明乾" parentid="576606">回复</a></label></div></div><div align="right">2013-08-16 22:34:13</div><div class="commentcontent">回复 qiufengy:<a href="http://freeloda.blog.51cto.com/#" class="anchor_page" title="加载中....." style="cursor:pointer" tid="1274533" parentid="576501">[1楼]</a><br><br>怎么说呢，keepalived是专门为LVS开发的高可用集群软件，在最近版本中支持script监控，但并没有提供脚本，得自己根据需要编写，对于刚入的朋友，起点有高。而heartbeat、corosync、pacemaker这些集群套件，就是为那此没有高可用的服务，提供高可用集群服务的。相对于keepalived通用性更高。</div></div><br><a name="576607"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid4"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[5楼]<a href="http://freeloda.blog.51cto.com/">楼主</a>&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://freeloda.blog.51cto.com/" class="operlink" ref="nofollow"><b>陈明乾</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="陈明乾" parentid="576607">回复</a></label></div></div><div align="right">2013-08-16 22:34:30</div><div class="commentcontent">回复 xiaoli110:<a href="http://freeloda.blog.51cto.com/#" class="anchor_page" title="加载中....." style="cursor:pointer" tid="1274533" parentid="576568">[2楼]</a><br><br>谢谢，一起进步！努力</div></div><br><a name="576608"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid5"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[6楼]<a href="http://freeloda.blog.51cto.com/">楼主</a>&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://freeloda.blog.51cto.com/" class="operlink" ref="nofollow"><b>陈明乾</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="陈明乾" parentid="576608">回复</a></label></div></div><div align="right">2013-08-16 22:34:59</div><div class="commentcontent">回复 jie783213507:<a href="http://freeloda.blog.51cto.com/#" class="anchor_page" title="加载中....." style="cursor:pointer" tid="1274533" parentid="576581">[3楼]</a><br><br>谢谢，可以一起讨论，学习！</div></div><br><a name="576725"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid6"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[7楼]&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://mageedu.blog.51cto.com/" class="operlink" ref="nofollow"><b>马哥教育</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="马哥教育" parentid="576725">回复</a></label></div></div><div align="right">2013-08-18 13:10:23</div><div class="commentcontent">思路整理得很清晰，没少下功夫！不错！</div></div><br><a name="576728"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid7"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[8楼]<a href="http://freeloda.blog.51cto.com/">楼主</a>&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://freeloda.blog.51cto.com/" class="operlink" ref="nofollow"><b>陈明乾</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="陈明乾" parentid="576728">回复</a></label></div></div><div align="right">2013-08-18 14:27:15</div><div class="commentcontent">回复 马哥教育:<a href="http://freeloda.blog.51cto.com/#" class="anchor_page" title="加载中....." style="cursor:pointer" tid="1274533" parentid="576725">[7楼]</a><br><br>谢谢，马哥！</div></div><br><a name="594318"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid8"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[9楼]&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://fuwenchao.blog.51cto.com/" class="operlink" ref="nofollow"><b>pianzif</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="pianzif" parentid="594318">回复</a></label></div></div><div align="right">2013-11-19 00:18:14</div><div class="commentcontent">博主你好，刚入行，你de博客很系统很强大！顶礼膜拜，学习中....有一个问题问下你:配置好vip后，ifconfig找不到eth0：0网卡呀？？？不知道是怎么回事！！！！  </div></div><br><a name="594319"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid9"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[10楼]&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://fuwenchao.blog.51cto.com/" class="operlink" ref="nofollow"><b>pianzif</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="pianzif" parentid="594319">回复</a></label></div></div><div align="right">2013-11-19 00:23:29</div><div class="commentcontent">是先ifconfig命令配好虚拟网卡然后再把该虚拟网卡添加为pacemaker的资源还是直接添加vip资源后虚拟网卡就可以用ifconfig查看到？？？但是我这里查不到呀，然后以为是没有启动起来，就ifconfig eht0：0 up  ，但是报错：网卡不能被绑定！！！！</div></div><br><a name="601318"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid10"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[11楼]&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://956768.blog.51cto.com/" class="operlink" ref="nofollow"><b>yeyeyeyuyu</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="yeyeyeyuyu" parentid="601318">回复</a></label></div></div><div align="right">2014-01-11 12:07:23</div><div class="commentcontent">回复 pianzif:<a href="http://freeloda.blog.51cto.com/#" class="anchor_page" title="加载中....." style="cursor:pointer" tid="1274533" parentid="594319">[10楼]</a><br><br>你理解错了，pacemaker配的虚拟地址是不会加多个虚拟网卡的，它的原理只是利用自带的send_arp来回应远端的arp请求，因此不需要配网卡，你也不会看到多一个网卡出现，ifconfig也是看不到的。</div></div><br><a name="601319"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid11"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[12楼]&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://956768.blog.51cto.com/" class="operlink" ref="nofollow"><b>yeyeyeyuyu</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="yeyeyeyuyu" parentid="601319">回复</a></label></div></div><div align="right">2014-01-11 12:17:13</div><div class="commentcontent">博主，INFUNTY是啥score？看的有点莫名其妙，测试貌似verify也正常。</div></div><br><a name="601320"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid12"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[13楼]&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://956768.blog.51cto.com/" class="operlink" ref="nofollow"><b>yeyeyeyuyu</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="yeyeyeyuyu" parentid="601320">回复</a></label></div></div><div align="right">2014-01-11 12:33:48</div><div class="commentcontent">回复 yeyeyeyuyu:<a href="http://freeloda.blog.51cto.com/#" class="anchor_page" title="加载中....." style="cursor:pointer" tid="1274533" parentid="601319">[12楼]</a><br><br>知道了，你这个 INFUNTY是score-attribute类型，而不是score。但是如果是score-attribute类型的话博主你应该提供一下rule吧。结合上下文，要不就是博主笔误，要不就是原先设定了INFUNTY attribute了。另外我自己测试没写rule也能verify成功，难道说pacemaker自身不检查score-attribute是否存在？我再随便用一个score-attribute类型名xx写入，也是没有报错。看来我猜测应该没错。</div></div><br><a name="601334"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid13"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[14楼]&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://956768.blog.51cto.com/" class="operlink" ref="nofollow"><b>yeyeyeyuyu</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="yeyeyeyuyu" parentid="601334">回复</a></label></div></div><div align="right">2014-01-11 15:36:47</div><div class="commentcontent">此外，由于HA集群本身并不强制每个节点的性能相同或相近。所以，某些时候我们可能希望在正常时服务总能在某个性能较强的节点上运行，这可以通过位置约束来实现：<br>crm(live)configure# location prefer-node1 vip node_pref::200: node1<br><br>博主，你貌似写错了吧。。。 语法应该是 location prefer-node1 vip 200: node1<br>没有node_pref，难怪敲半天命令老是提示我rule有问题。。。我用的是1.10版的pacemaker</div></div><br><a name="601336"></a><div class="itcomment" style="table-layout: fixed;word-wrap: break-word" id="itcommentid14"><div><div style="width:100%;border-bottom:1px solid #A0A0A0;height:20px"><label style="float:left">[15楼]<a href="http://freeloda.blog.51cto.com/">楼主</a>&nbsp;&nbsp;&nbsp;&nbsp;<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/reply.gif">&nbsp;&nbsp;<a target="_blank" href="http://freeloda.blog.51cto.com/" class="operlink" ref="nofollow"><b>陈明乾</b></a></label><label style="float:right">&nbsp;<a href="http://freeloda.blog.51cto.com/#" class="repost operlink" user_name="陈明乾" parentid="601336">回复</a></label></div></div><div align="right">2014-01-11 15:49:06</div><div class="commentcontent">回复 yeyeyeyuyu:<a href="http://freeloda.blog.51cto.com/#" class="anchor_page" title="加载中....." style="cursor:pointer" tid="1274533" parentid="601334">[14楼]</a><br><br>难得有博友真的会去实验，验证博客中的对错。博友加油……</div></div><br><div> <a href="" onclick="getcomment(1274533,1);return false">&nbsp;&lt;&lt;&nbsp;</a>&nbsp;&nbsp;<b>1</b>&nbsp; <a href="" onclick="getcomment(1274533,2);return false">&nbsp;2&nbsp;</a> <input type="text" size="2" style="height: 16px; border:1px solid #E5E5E5;" onkeydown="javascript: if(event.keyCode==13) getcomment(1274533,this.value);"> <a href="" onclick="getcomment(1274533,2);return false">&nbsp;&gt;&gt;&nbsp;</a>&nbsp;&nbsp;页数 ( 1/2 ) &nbsp;</div>
    </div><!--modCon-->
        <span class="modBot"></span>
</div><!--commBox end-->
<a href="" id="com_top_top"></a>
<form action="http://freeloda.blog.51cto.com/comment.php?" method="post" name="form1" id="form1" onsubmit="return commentSubmit(this,&quot;&quot;);">
<span class="blank1"></span>
<div class="box writeComm" style="min-height:30px;">
<a name="comment"></a>
<input type="hidden" name="action" value="comment">
<input id="commenttid" type="hidden" name="tid" value="1274533">
<input type="hidden" name="com_count_ajax" id="com_count_ajax" value="2">

 <div class="title">
	<h2 class="fl">发表评论&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h2>
	<span class="fl" id="messageTj">
<script type="text/javascript"><!--//<![CDATA[
   var m3_u = (location.protocol=='https:'?'https://gg.51cto.com/www/delivery/ajs.php':'http://gg2.51cto.com/www/delivery/ajs.php');
   var m3_r = Math.floor(Math.random()*99999999999);
   if (!document.MAX_used) document.MAX_used = ',';
   document.write ("<scr"+"ipt type='text/javascript' src='"+m3_u);
   document.write ("?zoneid=460");
   document.write ('&amp;cb=' + m3_r);
   if (document.MAX_used != ',') document.write ("&amp;exclude=" + document.MAX_used);
   document.write (document.charset ? '&amp;charset='+document.charset : (document.characterSet ? '&amp;charset='+document.characterSet : ''));
   document.write ("&amp;loc=" + escape(window.location));
   if (document.referrer) document.write ("&amp;referer=" + escape(document.referrer));
   if (document.context) document.write ("&context=" + escape(document.context));
   if (document.mmm_fo) document.write ("&amp;mmm_fo=1");
   document.write ("'><\/scr"+"ipt>");
//]]>--></script><script type="text/javascript" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/ajs.php"></script><a href="http://gg3.51cto.com/www/delivery/ck.php?oaparams=2__bannerid=1090__zoneid=460__cb=cfcb89dae2__oadest=http%3A%2F%2Fedu.51cto.com%2Factivity%2Flists%2Fid-15.html" target="_blank"><font color="red" style="text-decoration:underline">51CTO学院2周年庆，分享故事赢大礼包</font></a><div id="beacon_cfcb89dae2" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/lg.php" width="0" height="0" alt="" style="width: 0px; height: 0px;"></div>

</span>
	<style type="text/css">
		a.mred:link{ color:#ff0000; text-decoration:underline;}
		a.mred:visited{color:#ff0000;}
		a.mred:hover{color:#ff0000;}
		a.mred:active{color:#ff0000;}
	</style>
</div>
<div style="display:none" rel="51CTO电子期刊改版意见大征集，提你所需，建你所想！" id="ggBox">
<script type="text/javascript"><!--//<![CDATA[
   var m3_u = (location.protocol=='https:'?'https://gg.51cto.com/www/delivery/ajs.php':'http://gg2.51cto.com/www/delivery/ajs.php');
   var m3_r = Math.floor(Math.random()*99999999999);
   if (!document.MAX_used) document.MAX_used = ',';
   document.write ("<scr"+"ipt type='text/javascript' src='"+m3_u);
   document.write ("?zoneid=460");
   document.write ('&amp;cb=' + m3_r);
   if (document.MAX_used != ',') document.write ("&amp;exclude=" + document.MAX_used);
   document.write (document.charset ? '&amp;charset='+document.charset : (document.characterSet ? '&amp;charset='+document.characterSet : ''));
   document.write ("&amp;loc=" + escape(window.location));
   if (document.referrer) document.write ("&amp;referer=" + escape(document.referrer));
   if (document.context) document.write ("&context=" + escape(document.context));
   if (document.mmm_fo) document.write ("&amp;mmm_fo=1");
   document.write ("'><\/scr"+"ipt>");
//]]>--></script><script type="text/javascript" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/ajs.php"></script><a href="http://gg3.51cto.com/www/delivery/ck.php?oaparams=2__bannerid=1090__zoneid=460__cb=cfcb89dae2__oadest=http%3A%2F%2Fedu.51cto.com%2Factivity%2Flists%2Fid-15.html" target="_blank"><font color="red" style="text-decoration:underline">51CTO学院2周年庆，分享故事赢大礼包</font></a><div id="beacon_cfcb89dae2" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/lg.php" width="0" height="0" alt="" style="width: 0px; height: 0px;"></div>

</div>
<script>
document.getElementById("messageTj").innerHTML = document.getElementById("ggBox").innerHTML;
</script>
 <div class="modCon">

	<p style="margin:10px 10px 15px;">
  <span>温馨提示：博主拒绝匿名评论，请登录后再发表评论</span>
  <span><a href="http://home.51cto.com/index.php?reback=http%253A%252F%252Ffreeloda.blog.51cto.com%252F2033581%252F1274533" style="text-decoration:underline">登录</a>&nbsp;&nbsp;<a href="http://ucenter.51cto.com/reg_01.php?reback=http://blog.51cto.com" target="_blank" style="text-decoration: underline;">快速注册</a></span>
	</p>

</div><!--modCon-->
<span class="modBot"></span>
</div>
</form>
<script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/count.js"></script><script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/count.php"></script>
<div style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F2283d46608159c3b39fc9f1178809c21' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/h.js" type="text/javascript"></script><a href="http://tongji.baidu.com/hm-web/welcome/ico?s=2283d46608159c3b39fc9f1178809c21" target="_blank"><img border="0" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/21.gif" width="20" height="20"></a>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57622524-1', 'auto');
  ga('send', 'pageview');
</script>
</div>
<iframe id="iframe1" name="iframe1" width="0" height="0"></iframe>
<!--发表评论 end-->
</div>
</div>
<div id="f_close_box" style="width: 150px; height: 300px; position: fixed; top: 42%; left: 0px; z-index: 100; display: none;">

	<img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/wKioL1VHFCjRwiyNAAB-jIackwQ674.jpg" border="0" usemap="#Map1">
    <map name="Map1" id="Map1">
      <area shape="rect" coords="124,7,143,25" href="javascript:void(0);" onclick="document.getElementById(&#39;f_close_box&#39;).style.display=&#39;none&#39;;">
    </map>
    
</div>
<script language="javascript">
	function refimg(){
		var randval = Math.random();
		document.getElementById("secunum").src="/seccode.php?rnum="+randval;
	}
	function displaysecunum()
	{
		var displaystr = document.getElementById("secunum").style.display;
		if(displaystr == 'none')
		{
			refimg();
			document.getElementById("clickfont").style.display = 'none';
			document.getElementById("secunum").style.display = 'inline';
			document.getElementById("spanfont").style.display = 'inline';
		}
	}

	function showMsn(){
		document.getElementById("c02").style.display = "none";
		document.getElementById("c01").style.display = "block";
		document.getElementById("share").style.height = "83px";
		document.getElementById("share").style.background = "none";
	}
	function showBBS(){
		document.getElementById("c01").style.display = "none";
		document.getElementById("c02").style.display = "block";
		document.getElementById("share").style.height = "83px";
		document.getElementById("share").style.background = "none";
	}

	//资源页面，分享按钮
	function copyShareUrl(title){

		if (window.clipboardData){

			if(document.getElementById("c01").style.display == 'block')
			{
				copy = "推荐：" + title + "http://freeloda.blog.51cto.com/2033581/1274533";
				var alertText = "复制成功，你可以粘贴到MSN或QQ中发给好友。";
			}
			else
			{
				copy = "[url=" + "http://freeloda.blog.51cto.com/2033581/1274533" + "][u]" + title + "[/u][/url]";
				var alertText = "复制成功，你可以粘贴到论坛分享给坛友。";
			}
			window.clipboardData.clearData();
			window.clipboardData.setData("Text", copy);
			alert(alertText);
		}
		else if (window.netscape){
			alert("您使用的浏览器不支持此复制功能，请使用Ctrl+C或鼠标右键。");
			if(document.getElementById("c01").style.display == 'block')
			{
				document.getElementById("shareTextQM").value = "推荐：" + title + "http://freeloda.blog.51cto.com/2033581/1274533";
				document.getElementById("shareTextQM").select();
			}
			else
			{
				document.getElementById("shareTextBBS").value = "[url=" + "http://freeloda.blog.51cto.com/2033581/1274533" + "][u]" + title + "[/u][/url]";
                document.getElementById("shareTextBBS").select();
			}
		}
		return false;
	}
	function select_login(){
		document.getElementById('fixed').style.display='';
	}
	function commentcheck()
	{
		if(document.form1.content.value == "")
		{
			alert("评论内容为空!");
			document.form1.content.focus();
			return false;
		}
	}
	function changename(){

	var memberid=0;
	memberid="";

	if(document.getElementById('commentniming').checked){
		document.getElementById('commentusername').disabled=false;
		document.getElementById('commentusername').value='';
		document.getElementById("indexhidden").style.display="none";
		document.getElementById("commentindex").value='';
		document.getElementById("commentyanzheng").style.display="";
	}else{
		document.getElementById('commentusername').disabled=true;
		document.getElementById('commentusername').value="";
		document.getElementById("indexhidden").style.display="";
		document.getElementById("commentindex").value="http://.blog.51cto.com";
		if(memberid>8)
		{
			document.getElementById("commentyanzheng").style.display="none";
		}
	}
	}
	function openFavoulist()
	{
		window.open ('http://blog.51cto.com/mod/favourlist.php?tid=1274533','newwindow','height=300,width=500,top=400,left=400,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no,z-look=yes');
	}

	var e_zti = document.getElementById('zti');//有专题锚点
	var maodian = window.location.href;//锚点
	if (e_zti) {
		//e_zti.href= (/[#]+/.test(maodian)) ? maodian : maodian + "#zhuanti";
	}
</script>
<script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/jquery-1.7.1.min.js"></script>
<script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/jquery.cookie.js"></script>
<script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/jquery.top.js"></script>
<link href="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/blog_top.css" rel="stylesheet" type="text/css">
<!-- <script src="http://blog.51cto.com/js/blog_top_list.php" type="text/javascript" language="javascript"></script> -->
<script type="text/javascript" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/edu_search.js"></script>
<div id="message" class="blogpop" style="z-index: 100; width: 389px; height: 196px; position: absolute; bottom: 0px; right: 0px; overflow: hidden; display: none; top: 709px; background-color: rgb(255, 255, 255);"><iframe style="width:800px;height:536px;top:0px;left:0px;position:absolute;visibility:inherit;z-index:-1;" frameborder="0"></iframe>
<div style="height:36px;background:url(http://blog.51cto.com/image/blog_top/popbgx.jpg) repeat-x; position:relative;width:387px;border-right-color:#2668B7;border-right-width:2px;border-right-style:solid 2px #2668B7;"><span style="right:10px;padding:12px 0 0;position:absolute;top:0"><span style="margin-right:80px;color:#828282;width:190px;padding:10px 0 0 10px;font-size:14px">每日博报 精彩不止一点</span><img title="关闭" id="message_close" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/close.jpg" alt="关闭"></span><div style="width:387px;height:36px;left:0;overflow:hidden; text-indent:-999em;background:url(http://blog.51cto.com/image/blog_top/hdtit.jpg) no-repeat;border-right:solid 2px #2668B7;"><a style="display: block; height: 36px;width:138px;" target="_blank" href="http://blog.51cto.com/"></a>
</div>
<div style="clear:both;"></div>
</div>
	<div id="message_content" style="border-top:none;font-family:Microsoft YaHei;font-size:12px;width:389px;height:160pxpx;text-align:left;overflow:hidden;">
	<script type="text/javascript"><!--//<![CDATA[
	   var m3_u = (location.protocol=='https:'?'https://gg.51cto.com/www/delivery/ajs.php':'http://gg3.51cto.com/www/delivery/ajs.php');
	   var m3_r = Math.floor(Math.random()*99999999999);
	   if (!document.MAX_used) document.MAX_used = ',';
	   document.write ("<scr"+"ipt type='text/javascript' src='"+m3_u);
	   document.write ("?zoneid=454");
	   document.write ('&amp;cb=' + m3_r);
	   if (document.MAX_used != ',') document.write ("&amp;exclude=" + document.MAX_used);
	   document.write (document.charset ? '&amp;charset='+document.charset : (document.characterSet ? '&amp;charset='+document.characterSet : ''));
	   document.write ("&amp;loc=" + escape(window.location));
	   if (document.referrer) document.write ("&amp;referer=" + escape(document.referrer));
	   if (document.context) document.write ("&context=" + escape(document.context));
	   if (document.mmm_fo) document.write ("&amp;mmm_fo=1");
	   document.write ("'><\/scr"+"ipt>");
	//]]>--></script><script type="text/javascript" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/ajs(1).php"></script><div id="adTop" style="">
<div class="blogpopMain">
<div class="l">
<a target="_blank" href="http://wot.51cto.com/2015mobile/"><img width="105" height="105" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/wKiom1VURxLzcRxBAAA0cVa1cSM137.jpg"></a>
<p><a target="_blank" href="http://wot.51cto.com/2015mobile/">WOT移动互联网开发者大会</a></p>
</div>
<div class="r">
<h4 style="text-align:left;"><a target="_blank" href="http://maomaostyle.blog.51cto.com/2220531/1654994"> 当Azure遇上Docker会怎样？</a></h4>
<ul>
<li><a target="_blank" href="http://edu.51cto.com/course/course_id-783.html"> C++程序设计-开启对象新世界大门
</a></li>
<li><a style="color:red;" target="_blank" href="http://shutong.blog.51cto.com/1559738/1653800">带你创建Azure Point-to-Site VPN</a></li>
<li><a target="_blank" href="http://gnaw0725.blog.51cto.com/156601/1653137">PHP远程DoS漏洞深入分析及防护</a></li>
<li><a style="color:red;" target="_blank" href="http://edu.51cto.com/mobile/">下载学院APP百万豪礼送不停！
</a></li>
</ul>
</div>
</div>
</div><div id="beacon_61cfa00430" style="position: absolute; left: 0px; top: 0px; visibility: hidden;"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/lg(1).php" width="0" height="0" alt="" style="width: 0px; height: 0px;"></div>

	</div>
</div>
<style>
.backToTop {
    display: none;
	WIDTH: 45px;
	height:45px;
	BOTTOM: 20px;
     position: fixed;
    _position: absolute;
    right: 140px;
    bottom: 10px;
    _bottom: "auto";
    cursor: pointer;
    opacity: .6;
    filter: Alpha(opacity=60);
	text-indent:-9999px;
}
.tops { background:url(/images/tops.jpg) no-repeat center center; }
</style>
<script>
(function() {
	  $('#showMessagerDim').show();
	   var _html = $("#addTop").html();
	  if(get_cookie('blog_top')==''){
//		 show_pop();
	     jQuery.messager.showblogtop('', _html);
	     $("#message").find("#adTop").show();
	     var date=new Date();
	     var test = date.getTime();
	     document.cookie="blog_top=yes;domain=.blog.51cto.com;expires="+date.toGMTString()+";path=/;";
	     }
	    $("#showMessagerDim").click(function(){
	    	jQuery.messager.showblogtop('', _html);
			$("#message").find("#adTop").show();
			//removeIframe();
		});
		
		function get_cookie(Name) {
		    var search = Name + "=";
		    var returnvalue = "";
		    if (document.cookie.length > 0) {
		        offset = document.cookie.indexOf(search);
		        if (offset != -1) {
		            offset += search.length;

		            end1 = document.cookie.indexOf(";", offset);

		            if (end1 == -1)
		            end1 = document.cookie.length;
		            returnvalue=unescape(document.cookie.substring(offset, end1));
		        }
		    }
		    return returnvalue;
		}
	})();

</script>
<script type="text/javascript">
(function() {
    var backToTopTxt = "返回顶部", backToTopEle = $('<div class="backToTop tops"></div>').appendTo($("body"))
        .text(backToTopTxt).attr("title", backToTopTxt).click(function() {
            $("html, body").animate({ scrollTop: 0 }, 520);
    }), backToTopFun = function() {
        var st = $(document).scrollTop(), winh = $(window).height();
        (st > 0)? backToTopEle.show(): backToTopEle.hide();    
        //IE6下的定位
        if (!window.XMLHttpRequest) {
            backToTopEle.css("top", st + winh - 60);    
        }
    };
    $(window).bind("scroll", backToTopFun);
    $(function() { backToTopFun(); });
})();
</script><div class="backToTop tops" title="返回顶部" style="display: block;">返回顶部</div>






<div class="clear"></div>
<!-- <script>
jQuery(function(){
	var html= "<div id=\"sogou_se_tgbar\" style=\"text-align:center;margin:0px auto 2px auto;clear:both;background:url(http://home.51cto.com/public/images/notice/sogou_se_tgbar_bg_final1.gif) repeat-x;width:950px;color:#000;font-size:13px;height:36px;z-index:21474836471\"><div style=\"float:left;cursor:pointer;width:910px;text-align:center;border-left:solid #efbf00 1px;height:32px; line-height:32px;txt-align:center;\"><span style=\"\">	<a href=\"http://51ctoblog.blog.51cto.com/26414/1093282\">【新年祝福征集】51CTO社区年底嘉年华活动正在征集博主祝福语，祝福以红包的形式随机的赠送给访问51CTO的网友 点此送祝福>></a></span></div><div onclick=\"document.getElementById('sogou_se_tgbar').style.display = 'none';\" style=\"float:right;width:20px;cursor:pointer;height:28px;padding:4px 8px 0px 8px;border-right:solid #efbf00 1px\"><img style=\"border:none;margin:4px 0px 0px 0px;\" src=\"http://home.51cto.com/public/images/notice/sogou_se_tgbar_close_final1.gif\"></div></div>"
	jQuery('body').prepend(html);
})
</script> -->

<div id="footer">
  <div id="innerFooter">
	<center>
		<small>
			Copyright By 51CTO.COM 版权所有<br><br>
			<a href="http://blog.51cto.com/" target="_blank"><img src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/copyright.jpg"></a>
	  </small>
	</center>
  </div>
</div>
<script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/index.php" charset="utf-8"></script>
<div style="display:none">
<script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/count.js"></script><script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/count(1).php"></script>
<div style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F2283d46608159c3b39fc9f1178809c21' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/h.js" type="text/javascript"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57622524-1', 'auto');
  ga('send', 'pageview');
</script>
</div>
<iframe frameborder="0" scrolling="no" width="0" height="0" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/pageview.html"></iframe>
</div>
<div style="display:none;"><script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/stat.php" language="JavaScript"></script><script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=4274540" target="_blank" title="站长统计"><img border="0" hspace="0" vspace="0" src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/pic.gif"></a><div>
<script src="./Linux 高可用（HA）集群之Pacemaker详解 - Share your knowledge … - 51CTO技术博客_files/poptop.js"></script>



</div></div></body></html>